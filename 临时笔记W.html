<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"><title>Janvy's blog | Janvy's blog</title><meta name="author" content="Janvy Sun"><meta name="copyright" content="Janvy Sun"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="文档链接设计模式https:&#x2F;&#x2F;www.coonote.com&#x2F;cpp-design-pattern&#x2F;how-to-learn-cpp-design-patterns.html (C++) https:&#x2F;&#x2F;www.runoob.com&#x2F;design-pattern&#x2F;design-pattern-resources.html (Java) Github 美化https:&#x2F;&#x2F;zhuanlan.zhih"><meta property="og:type" content="website"><meta property="og:title" content="Janvy&#39;s blog"><meta property="og:url" content="https://janvysun.github.io/%E4%B8%B4%E6%97%B6%E7%AC%94%E8%AE%B0W.html"><meta property="og:site_name" content="Janvy&#39;s blog"><meta property="og:description" content="文档链接设计模式https:&#x2F;&#x2F;www.coonote.com&#x2F;cpp-design-pattern&#x2F;how-to-learn-cpp-design-patterns.html (C++) https:&#x2F;&#x2F;www.runoob.com&#x2F;design-pattern&#x2F;design-pattern-resources.html (Java) Github 美化https:&#x2F;&#x2F;zhuanlan.zhih"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://janvysun.github.io/images/hexo.png"><meta property="article:published_time" content="2024-03-18T05:54:05.433Z"><meta property="article:modified_time" content="2024-03-18T05:54:05.433Z"><meta property="article:author" content="Janvy Sun"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://janvysun.github.io/images/hexo.png"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://janvysun.github.io/%E4%B8%B4%E6%97%B6%E7%AC%94%E8%AE%B0W"><link rel="preconnect" href="//cdn.jsdelivr.net"><link rel="preconnect" href="//busuanzi.ibruce.info"><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6/css/all.min.css" media="print" onload='this.media="all"'><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.css" media="print" onload='this.media="all"'><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: [object Object]
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE={title:"Janvy's blog",isPost:!1,isHome:!1,isHighlightShrink:!1,isToc:!1,postUpdate:"2024-03-18 13:54:05"}</script><noscript><style type="text/css">#nav{opacity:1}.justified-gallery img{opacity:1}#post-meta time,#recent-posts time{display:inline!important}</style></noscript><script>(e=>{e.saveToLocal={set:function(e,t,o){if(0===o)return;const n=864e5*o,a={value:t,expiry:(new Date).getTime()+n};localStorage.setItem(e,JSON.stringify(a))},get:function(e){const t=localStorage.getItem(e);if(!t)return;const o=JSON.parse(t);if(!((new Date).getTime()>o.expiry))return o.value;localStorage.removeItem(e)}},e.getScript=e=>new Promise((t,o)=>{const n=document.createElement("script");n.src=e,n.async=!0,n.onerror=o,n.onload=n.onreadystatechange=function(){const e=this.readyState;e&&"loaded"!==e&&"complete"!==e||(n.onload=n.onreadystatechange=null,t())},document.head.appendChild(n)}),e.activateDarkMode=function(){document.documentElement.setAttribute("data-theme","dark"),null!==document.querySelector('meta[name="theme-color"]')&&document.querySelector('meta[name="theme-color"]').setAttribute("content","#0d0d0d")},e.activateLightMode=function(){document.documentElement.setAttribute("data-theme","light"),null!==document.querySelector('meta[name="theme-color"]')&&document.querySelector('meta[name="theme-color"]').setAttribute("content","#ffffff")};const t=saveToLocal.get("theme");"dark"===t?activateDarkMode():"light"===t&&activateLightMode();const o=saveToLocal.get("aside-status");void 0!==o&&("hide"===o?document.documentElement.classList.add("hide-aside"):document.documentElement.classList.remove("hide-aside"));/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)&&document.documentElement.classList.add("apple")})(window)</script><meta name="generator" content="Hexo 6.1.0"></head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">加载中...</div></div></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/images/avatar.jpg" onerror='onerror=null,src="/img/friend_404.gif"' alt="avatar"></div><div class="site-data is-center"><div class="data-item"><a href="/archives/"><div class="headline">文章</div><div class="length-num">153</div></a></div><div class="data-item"><a href="/tags/"><div class="headline">标签</div><div class="length-num">47</div></a></div><div class="data-item"><a href="/categories/"><div class="headline">分类</div><div class="length-num">13</div></a></div></div><hr><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 链接</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="page" id="body-wrap"><header class="not-home-page" id="page-header"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">Janvy's blog</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 链接</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="page-site-info"><h1 id="site-title">Janvy's blog</h1></div></header><main class="layout" id="content-inner"><div id="page"><div id="article-container"><h1 id="文档链接"><a href="#文档链接" class="headerlink" title="文档链接"></a>文档链接</h1><h2 id="设计模式"><a href="#设计模式" class="headerlink" title="设计模式"></a>设计模式</h2><p><a target="_blank" rel="noopener" href="https://www.coonote.com/cpp-design-pattern/how-to-learn-cpp-design-patterns.html">https://www.coonote.com/cpp-design-pattern/how-to-learn-cpp-design-patterns.html</a> (C++)</p><p><a target="_blank" rel="noopener" href="https://www.runoob.com/design-pattern/design-pattern-resources.html">https://www.runoob.com/design-pattern/design-pattern-resources.html</a> (Java)</p><h2 id="Github-美化"><a href="#Github-美化" class="headerlink" title="Github 美化"></a>Github 美化</h2><p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/533850515">https://zhuanlan.zhihu.com/p/533850515</a></p><br><h2 id="CAS-相关"><a href="#CAS-相关" class="headerlink" title="CAS 相关"></a>CAS 相关</h2><p><a target="_blank" rel="noopener" href="http://www.ibloger.net/tags-1641.html">http://www.ibloger.net/tags-1641.html</a></p><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/u010475041/category_7156505.html">https://blog.csdn.net/u010475041/category_7156505.html</a></p><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/anumbrella/category_7765386.html">https://blog.csdn.net/anumbrella/category_7765386.html</a></p><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/zhuwei_clark/article/details/90450316">https://blog.csdn.net/zhuwei_clark/article/details/90450316</a></p><h3 id="https-www-javaxks-com-cat-177"><a href="#https-www-javaxks-com-cat-177" class="headerlink" title="https://www.javaxks.com/?cat=177"></a><a target="_blank" rel="noopener" href="https://www.javaxks.com/?cat=177">https://www.javaxks.com/?cat=177</a></h3><h4 id="cas安装篇"><a href="#cas安装篇" class="headerlink" title="cas安装篇"></a>cas安装篇</h4><ul><li>CAS之5.2x版本单点登录服务安装-yellowcong</li></ul><h4 id="cas-进阶篇"><a href="#cas-进阶篇" class="headerlink" title="cas 进阶篇"></a>cas 进阶篇</h4><ul><li>CAS之5.2x版本自定义登录页面-yellowcong</li><li>CAS之5.2x版本自定义返回消息-yellowcong</li><li>CAS之5.2x版本自定义错误信息-yellowcong</li><li>CAS之5.2x版本之服务器开发调试&amp;#xff08;eclipse调试cas&amp;#xff09;-yellowcong</li><li>CAS之5.1.x版本自定义表单信息-yellowcong</li><li>CAS之5.2.x版本自定义表单信息-yellowcong</li><li>CAS之 5.2x版本配置数据库认证-yellowcong</li><li>Cas5.2之存储Service信息到数据库-yellowcong</li><li>Cas5.2之用户密码邮箱找回-yellowcong</li><li>CAS之5.2x版本之OAuth2.0-yellowcong</li><li>CAS之5.2x版本之REST验证ticket&amp;#xff08;跨系统访问资源&amp;#xff09;-yellowcong</li><li>CAS之5.2x版本之Ajax方式提交表单-yellowcong</li><li>CAS之5.2x版本登录验证码-yellowcong</li><li>CAS之5.2x版本存储Ticket到redis-yellowcong</li><li>CAS5.2之通过Rest来动态访问子系统资源-yellowcong</li><li>CAS之5.2x版本之服务管理-yellowcong</li><li>CAS之5.2x版本之单点登录退出-yellowcong</li><li>CAS之5.2x版本自定义登录&amp;#xff0c;多数据源登录-yellowcong</li><li>Shiro之CAS单点登录-yellowcong</li><li>Cas之5.2.x版本单点登录自定义REST认证-yellowcong</li><li>CAS之5.2x版本自定义密码验证-yellowcong</li><li>Cas5.2之管理登录后一直显示Lodding-yellowcong</li><li>Cas5.2之Management 通过Mysql管理服务-yellowcong</li><li>Cas5.2之Cas的java客户端-yellowcong</li><li>CAS之5.2x版本配置密码加密(MD5和SHA)-yellowcong</li><li>CAS之5.2x版本自定义密码验证-yellowcong</li></ul><h4 id="集成篇"><a href="#集成篇" class="headerlink" title="集成篇"></a>集成篇</h4><ul><li>CAS之5.2x版本之Gerrit单点登录-yellowcong</li><li>Cas5.2之Gerrit创建用户并关联-yellowcnog</li><li>CAS之5.2x版本之Jenkins单点登录-yellowcong</li><li>CAS之5.2x版本之Gitlab单点登录-yellowcong</li><li>CAS之5.2x版本之Confluence单点登录-yellowcong</li><li>CAS之5.2x版本之Jira单点登录(7.2)版本-yellowcong</li><li>CAS之5.2x版本之Jira单点登录(8.x)版本-yellowcong</li><li>CAS之5.2x版本之客户端集成&amp;#xff08;Springboot&amp;#xff09;-yellowcong</li><li>CAS之5.2x版本之客户端集成&amp;#xff08;传统web项目&amp;#xff09;-yellowcong</li><li>graylog接入cas-yelowcong</li><li>Cas之Sonar接入sso-yellowcong</li><li>Grafana与cas集成-yellowcong</li><li>Grafana与cas集成-yellowcong</li><li>ldap和cas整合|第七章-yellowcong</li></ul><h1 id="WT"><a href="#WT" class="headerlink" title="WT"></a>WT</h1><h2 id="去除右击打开-WT（Win10）"><a href="#去除右击打开-WT（Win10）" class="headerlink" title="去除右击打开 WT（Win10）"></a>去除右击打开 WT（Win10）</h2><p>Windows Terminal 安装完成之后，在桌面鼠标右击会显示「在 Windows Terminal 中打开」的一个选项，可以修改注册表来关闭它。</p><p>新建一个 <code>.reg</code> 文件，在其中写入如下内容：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Windows Registry Editor Version 5.00</span><br><span class="line"></span><br><span class="line">[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Shell Extensions\Blocked]</span><br><span class="line">&quot;&#123;9F156763-7844-4DC4-B2B1-901F640F5155&#125;&quot;=&quot;WindowsTerminal&quot;</span><br></pre></td></tr></table></figure><p>然后双击运行它，之后重启电脑或者注销用户即可生效。</p><br><h1 id="sql"><a href="#sql" class="headerlink" title="sql"></a>sql</h1><p>TIMESTAMPDIFF定义：函数日期或日期时间表达式之间的整数差</p><p>DB2中采用TIMESTAMPDIFF方法<br><code>TIMESTAMPDIFF( n , CHAR(TIMESTAMP(&#39;2021-05-08-11.07.22&#39;)-TIMESTAMP(&#39;2021-05-08-11.08.22&#39;)))</code></p><p>其中的n可以使用其他的值来代替，看你需要求的是哪些结果的时间单位吧。</p><ul><li>1：毫秒</li><li>2：秒</li><li>4：分</li><li>8：时</li><li>16：天</li><li>32：周</li><li>64：月</li><li>128：季度</li><li>256：年</li></ul><p>MYSQL中采用TIMESTAMPDIFF方法： <code>TIMESTAMPDIFF(n，datetime1，datetime2)</code><br>需要将n的值改成以下格式</p><ul><li>FRAC_SECOND：毫秒</li><li>SECOND：秒</li><li>MINUTE：分钟</li><li>HOUR：小时</li><li>DAY：天</li><li>WEEK：星期</li><li>MONTH：月</li><li>QUARTER：季度</li><li>YEAR：年</li></ul><br><h1 id="on-my-posh"><a href="#on-my-posh" class="headerlink" title="on my posh"></a>on my posh</h1><h2 id="windows"><a href="#windows" class="headerlink" title="windows"></a>windows</h2><p>1、字体安装：</p><p>可能出现乱码，字体安装推荐像Cascadia Code的字体，Caskaydia Cove Nerd Font | 下载</p><p>2、安装oh-my-posh</p><p>winget install oh-my-posh<br>3、配置主题，其中xxx.omp.json为你想要的主题名称，样式预览 oh-my-posh3主题预览 - 久漫 - 博客园 (cnblogs.com) ，其中查看主题位置可以使用命令 $env:POSH_THEMES_PATH</p><p>notepad $PROFILE<br>#最后一行输入<br>oh-my-posh init pwsh –config “$env:POSH_THEMES_PATH\paradox.omp.json” | Invoke-Expression<br>4、其中PowerShell文件图标需要额外的安装</p><p>Install-Module -Name Terminal-Icons -Repository PSGallery<br>Import-Module -Name Terminal-Icons<br>Get-ChildItem -Path . -Force ##查看效果<br>每次重启PowerShell都要重新导入模块 Import-Module -Name Terminal-Icons，为了避免这种情况，在配置文件中加入即可，每次启动都会自动使用这个命令了。</p><p>notepad $PROFILE<br>#最后一行输入<br>Import-Module -Name Terminal-Icons</p><h2 id="linux"><a href="#linux" class="headerlink" title="linux"></a>linux</h2><p>1、字体安装教程 ： ubuntu安装字体</p><p>2、安装oh-my-posh</p><p>参考链接： Linux | Oh My Posh</p><p>sudo wget <a target="_blank" rel="noopener" href="https://github.com/JanDeDobbeleer/oh-my-posh/releases/latest/download/posh-linux-amd64">https://github.com/JanDeDobbeleer/oh-my-posh/releases/latest/download/posh-linux-amd64</a> -O &#x2F;usr&#x2F;local&#x2F;bin&#x2F;oh-my-posh<br>sudo chmod +x &#x2F;usr&#x2F;local&#x2F;bin&#x2F;oh-my-posh<br>3、载入them</p><p>mkdir <del>&#x2F;.poshthemes<br>wget <a target="_blank" rel="noopener" href="https://github.com/JanDeDobbeleer/oh-my-posh/releases/latest/download/themes.zip">https://github.com/JanDeDobbeleer/oh-my-posh/releases/latest/download/themes.zip</a> -O ~&#x2F;.poshthemes&#x2F;themes.zip<br>unzip ~&#x2F;.poshthemes&#x2F;themes.zip -d ~&#x2F;.poshthemes<br>chmod u+rw ~&#x2F;.poshthemes&#x2F;<em>.omp.</em><br>rm ~&#x2F;.poshthemes&#x2F;themes.zip<br>主题可以直接在Themes | Oh My Posh 查看，找到喜欢的json名字，在</del>&#x2F;.poshthemes下查看是否存在。</p><p>4、启用主题，xxx.omp.json为你想要的主题（如果要默认启动就在etc&#x2F;profile最后一行加入这个）</p><p>eval “$(oh-my-posh –init –shell bash –config ~&#x2F;.poshthemes&#x2F;clean-detailed.omp.json)”</p><br><h1 id="C"><a href="#C" class="headerlink" title="C++"></a>C++</h1><h2 id="QT"><a href="#QT" class="headerlink" title="QT"></a>QT</h2><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/m0_73443478/category_12075511.html">https://blog.csdn.net/m0_73443478/category_12075511.html</a></p><h3 id="容器"><a href="#容器" class="headerlink" title="容器"></a>容器</h3><h4 id="QList"><a href="#QList" class="headerlink" title="QList"></a>QList</h4><p>QList 是最常用的容器类，虽然它是以数组列表（array-list）的形式实现的，但是在其前或后添加数据非常快，QList以下标索引的方式对数据项进行访问。</p><p>QList用于添加、插入、替换、移动、删除数据项的函数有：insert()、replace()、removeAt()、move()、swap()、append()、prepend()、removeFirst()和removeLast()等。</p><p>QList提供下标索引方式访问数据项，如同数组一样，也提供at()函数，例如：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">QList&lt;QString&gt; list;</span><br><span class="line">list &lt;&lt; <span class="string">&quot;one&quot;</span> &lt;&lt; <span class="string">&quot;two&quot;</span> &lt;&lt; <span class="string">&quot;three&quot;</span>;</span><br><span class="line">QString str1=list[<span class="number">1</span>];   <span class="comment">//str1==&quot;two&quot;</span></span><br><span class="line">QString str0=list.<span class="built_in">at</span>(<span class="number">0</span>);   <span class="comment">//str0==&quot;one&quot;</span></span><br></pre></td></tr></table></figure><p>QList的isEmpty()函数在数据项为空时返回true，size()函数返回数据项的个数。</p><p>QList是Qt中最常用的容器类，很多函数的参数传递都是采用QList容器类，例如QAudioDeviceInfo的静态函数availableDevices()的函数原型是：</p><p><code>QList&lt;QAudioDeviceInfo&gt; QAudioDeviceInfo::availableDevices(QAudio::Mode mode)</code></p><p>其返回数据就是QAudioDeviceInfo类型的QList列表。</p><h4 id="QLinkedList"><a href="#QLinkedList" class="headerlink" title="QLinkedList"></a>QLinkedList</h4><p>QLinkedList是链式列表（linked-list），数据项不是用连续的内存存储的，它基于迭代器访问数据项，并且插入和删除数据项的操作时间相同。</p><p>除了不提供基于下标索引的数据项访问外，QLinkedList的其他接口函数与QList基本相同。</p><h4 id="QVector"><a href="#QVector" class="headerlink" title="QVector"></a>QVector</h4><p>QVector提供动态数组的功能，以下标索引访问数据。</p><p>QVector的函数接口与QList几乎完全相同，QVector的性能比QList更高，因为QVector的数据项是连续存储的。</p><h4 id="QStack"><a href="#QStack" class="headerlink" title="QStack"></a>QStack</h4><p>QStack是提供类似于堆栈的后入先出（LIFO）操作的容器类，push()和pop()是主要的接口函数。例如：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">QStack&lt;<span class="type">int</span>&gt; stack;</span><br><span class="line">stack.<span class="built_in">push</span>(<span class="number">10</span>);</span><br><span class="line">stack.<span class="built_in">push</span>(<span class="number">20</span>);</span><br><span class="line">stack.<span class="built_in">push</span>(<span class="number">30</span>);</span><br><span class="line"><span class="keyword">while</span> (!stack.<span class="built_in">isEmpty</span>())</span><br><span class="line">   cout &lt;&lt; stack.<span class="built_in">pop</span>() &lt;&lt; endl;</span><br></pre></td></tr></table></figure><p>程序会依次输出30，20，10。</p><h4 id="QQueue"><a href="#QQueue" class="headerlink" title="QQueue"></a>QQueue</h4><p>QQueue是提供类似于队列先入先出（FIFO）操作的容器类。enqueue()和dequeue()是主要操作函数。例如：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">QQueue&lt;<span class="type">int</span>&gt; queue;</span><br><span class="line">queue.<span class="built_in">enqueue</span>(<span class="number">10</span>);</span><br><span class="line">queue.<span class="built_in">enqueue</span>(<span class="number">20</span>);</span><br><span class="line">queue.<span class="built_in">enqueue</span>(<span class="number">30</span>);</span><br><span class="line"><span class="keyword">while</span> (!queue.<span class="built_in">isEmpty</span>())</span><br><span class="line">   cout &lt;&lt; queue.<span class="built_in">dequeue</span>() &lt;&lt; endl;</span><br></pre></td></tr></table></figure><p>程序会依次输出10，20，30。</p><h4 id="QSet"><a href="#QSet" class="headerlink" title="QSet"></a>QSet</h4><p>QSet 是基于散列表的集合模板类，它存储数据的顺序是不定的，查找值的速度非常快。QSet 内部就是用QHash实现的。</p><p>定义QSet容器和输入数据的实例代码如下：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">QSet&lt;QString&gt; set;</span><br><span class="line">set &lt;&lt; <span class="string">&quot;dog&quot;</span> &lt;&lt; <span class="string">&quot;cat&quot;</span> &lt;&lt; <span class="string">&quot;tiger&quot;</span>;</span><br></pre></td></tr></table></figure><p>测试一个值是否包含于这个集合，用contains()函数，示例如下：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (!set.<span class="built_in">contains</span>(<span class="string">&quot;cat&quot;</span>))</span><br><span class="line">     ...</span><br></pre></td></tr></table></figure><h4 id="QMap"><a href="#QMap" class="headerlink" title="QMap"></a>QMap</h4><p><code>QMap&lt;Key, T&gt;</code>提供一个字典（关联数组），一个键映射到一个值。QMap存储数据是按照键的顺序，如果不在乎存储顺序，使用QHash会更快。</p><p>定义QMap&lt;QString, int&gt;类型变量和赋值的示例代码如下：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">QMap&lt;QString, <span class="type">int</span>&gt; map;</span><br><span class="line">map[<span class="string">&quot;one&quot;</span>] = <span class="number">1</span>;</span><br><span class="line">map[<span class="string">&quot;two&quot;</span>] = <span class="number">2</span>;</span><br><span class="line">map[<span class="string">&quot;three &quot;</span>] = <span class="number">3</span>;</span><br></pre></td></tr></table></figure><p>也可以使用insert()函数赋值，或remove()移除一个键值对，示例如下：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">map.<span class="built_in">insert</span>(<span class="string">&quot;four&quot;</span>, <span class="number">4</span>);</span><br><span class="line">map.<span class="built_in">remove</span>(<span class="string">&quot;two&quot;</span>);</span><br></pre></td></tr></table></figure><p>要查找一个值，使用运算符“[ ]”或value()函数，示例如下：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> num1 = map[<span class="string">&quot;one&quot;</span>];</span><br><span class="line"><span class="type">int</span> num2 = map.<span class="built_in">value</span>(<span class="string">&quot;two&quot;</span>);</span><br></pre></td></tr></table></figure><p>如果在映射表中没有找到指定的键，会返回一个缺省构造值（default-constructed values），例如，如果值的类型是字符串，会返回一个空的字符串。</p><p>在使用value()函数查找键值时，还可以指定一个缺省的返回值，示例如下：</p><p><code>timeout = map.value(&quot;TIMEOUT&quot;,30);</code></p><p>这表示如果在map里找到键“TIMEOUT”，就返回关联的值，否则返回值为30。</p><h4 id="QMultiMap"><a href="#QMultiMap" class="headerlink" title="QMultiMap"></a>QMultiMap</h4><p>QMultiMap是QMap的子类，是用于处理多值映射的便利类。</p><p>多值映射就是一个键可以对应多个值。QMap正常情况下不允许多值映射，除非使用QMap::insertMulti()添加键值对。</p><p>QMultiMap是QMap的子类，所以QMap的大多数函数在QMultiMap都是可用的，但是有几个特殊的，QMultiMap::insert()等效于QMap::insertMulti()，QMultiMap::replace()等效于QMap::insert()。</p><p>QMultiMap使用示例如下：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">QMultiMap&lt;QString, <span class="type">int</span>&gt; map1, map2, map3;</span><br><span class="line">map1.<span class="built_in">insert</span>(<span class="string">&quot;plenty&quot;</span>, <span class="number">100</span>);</span><br><span class="line">map1.<span class="built_in">insert</span>(<span class="string">&quot;plenty&quot;</span>, <span class="number">2000</span>);   <span class="comment">// map1.size() == 2</span></span><br><span class="line">map2.<span class="built_in">insert</span>(<span class="string">&quot;plenty&quot;</span>, <span class="number">5000</span>);   <span class="comment">// map2.size() == 1</span></span><br><span class="line">map3 = map1 + map2;            <span class="comment">// map3.size() == 3</span></span><br></pre></td></tr></table></figure><p>QMultiMap不提供“[ ]”操作符，使用value()函数访问最新插入的键的单个值。如果要获取一个键对应的所有值，使用values()函数，返回值是QList类型。</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">QList&lt;<span class="type">int</span>&gt; values = map.<span class="built_in">values</span>(<span class="string">&quot;plenty&quot;</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; values.<span class="built_in">size</span>(); ++i)</span><br><span class="line">   cout &lt;&lt; values.<span class="built_in">at</span>(i) &lt;&lt; endl;</span><br></pre></td></tr></table></figure><h4 id="QHash"><a href="#QHash" class="headerlink" title="QHash"></a>QHash</h4><p>QHash是基于散列表来实现字典功能的模板类，<code>QHash&lt;Key, T&gt;</code>存储的键值对具有非常快的查找速度。</p><p>QHash与QMap的功能和用法相似，区别在于以下几点：</p><p>QHash比QMap的查找速度快；<br>在QMap上遍历时，数据项是按照键排序的，而QHash的数据项是任意顺序的；<br>QMap的键必须提供“&lt;”运算符，QHash的键必须提供“&#x3D;&#x3D;”运算符和一个名称为qHash()的全局散列函数。</p><h4 id="QMultiHash"><a href="#QMultiHash" class="headerlink" title="QMultiHash"></a>QMultiHash</h4><p>QMultiHash是QHash的子类，是用于处理多值映射的便利类，其用法与QMultiMap类似。</p><h3 id="容器类的迭代"><a href="#容器类的迭代" class="headerlink" title="容器类的迭代"></a>容器类的迭代</h3><p>就是我们使用的迭代器。<br>迭代器（iterator）为访问容器类里的数据项提供了统一的方法，Qt有两种迭代器类：Java类型的迭代器和STL类型的迭代器。</p><p>Java类型的迭代器更易于使用，且提供一些高级功能，而STL类型的迭代器效率更高。</p><p>Qt还提供一个关键字foreach（实际是&lt; QtGlobal &gt;里定义的一个宏）用于方便地访问容器里所有数据项。</p><p>对于每个容器类，有两个Java类型迭代器：一个用于只读操作，一个用于读写操作，各个Java类型的容器类见表。</p><p>表　Java类型的迭代器类</p><p>容器类 只读迭代器 读写迭代器<br>QList<t>, QQueue<t>QListIterator<t>QMutableListIterator<t><br>QLinkedList<t>QLinkedListIterator<t>QMutableLinkedListIterator<t><br>QVector<t>, QStack<t>QVectorIterator<t>QMutableVectorIterator<t><br>QSet<t>QSetIterator<t>QMutableSetIterator<t><br>QMap&lt;Key, T&gt;, QMultiMap&lt;Key, T&gt; QMapIterator&lt;Key, T&gt; QMutableMapIterator&lt;Key, T&gt;<br>QHash&lt;Key, T&gt;, QMultiHash&lt;Key, T&gt; QHashIterator&lt;Key, T&gt; QMutableHashIterator&lt;Key, T&gt;<br>QMap和QHash等关联容器类的迭代器用法相同，QList和QLinkedList、QSet等容器类的用法相同，所以下面只以QMap和QList为例介绍迭代器的用法。</t></t></t></t></t></t></t></t></t></t></t></t></t></t></p><h4 id="顺序容器类的迭代器的使用"><a href="#顺序容器类的迭代器的使用" class="headerlink" title="顺序容器类的迭代器的使用"></a>顺序容器类的迭代器的使用</h4><p>Java类型迭代器的指针不是指向一个数据项，而是在数据项之间，迭代器指针位置示意图如图所示。</p><p>下面是遍历访问一个QList容器的所有数据项的典型代码。</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">QList&lt;QString&gt; list;</span><br><span class="line">list &lt;&lt; <span class="string">&quot;A&quot;</span> &lt;&lt; <span class="string">&quot;B&quot;</span> &lt;&lt; <span class="string">&quot;C&quot;</span> &lt;&lt; <span class="string">&quot;D&quot;</span>;</span><br><span class="line"><span class="function">QListIterator&lt;QString&gt; <span class="title">i</span><span class="params">(list)</span></span>;</span><br><span class="line"><span class="keyword">while</span> (i.<span class="built_in">hasNext</span>())</span><br><span class="line">   <span class="built_in">qDebug</span>() &lt;&lt; i.<span class="built_in">next</span>();</span><br></pre></td></tr></table></figure><p>QList&lt; QString&gt;容器对象list作为参数传递给QListIterator&lt; QString &gt;迭代器i的构造函数，i用于对list作只读遍历。起始时刻，迭代器指针在容器第一个数据项的前面（图中数据项“A”的前面），调用hasNext()判断在迭代器指针后面是否还有数据项，如果有，就调用next()跳过一个数据项，并且next()函数返回跳过去的那个数据项。</p><p>也可以反向遍历，示例代码如下：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">QListIterator&lt;QString&gt; <span class="title">i</span><span class="params">(list)</span></span>;</span><br><span class="line">i.<span class="built_in">toBack</span>();</span><br><span class="line"><span class="keyword">while</span> (i.<span class="built_in">hasPrevious</span>())</span><br><span class="line">   <span class="built_in">qDebug</span>() &lt;&lt; i.<span class="built_in">previous</span>();</span><br></pre></td></tr></table></figure><p>QListIterator用于移动指针和读取数据的函数见表2。</p><p>表2　QListIterator常用函数</p><p>函数名 功能<br>void　toFront() 迭代器移动到列表的最前面（第一个数据项之前）<br>void　toBack() 迭代器移动到列表的最后面（最后一个数据项之后）<br>bool　hasNext() 如果迭代器不是位于列表最后位置，返回true<br>const T &amp; next() 返回下一个数据项，并且迭代器后移一个位置<br>const T &amp; peekNext() 返回下一个数据项，但是不移动迭代器位置<br>bool　hasPrevious() 如果迭代器不是位于列表的最前面，返回true<br>const T &amp; previous() 返回前一个数据项，并且迭代器前移一个位置<br>const T &amp; peekPrevious() 返回前一个数据项，但是不移动迭代器指针<br>QListIterator是只读访问容器内数据项的迭代器，若要在遍历过程中对容器的数据进行修改，需要使用QMutableListIterator。例如下面的示例代码为删除容器中数据为奇数的项。</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">QList&lt;<span class="type">int</span>&gt; list;</span><br><span class="line">list &lt;&lt;<span class="number">1</span> &lt;&lt;<span class="number">2</span>&lt;&lt;<span class="number">3</span>&lt;&lt;<span class="number">4</span>&lt;&lt;<span class="number">5</span>;</span><br><span class="line"><span class="function">QMutableListIterator&lt;<span class="type">int</span>&gt; <span class="title">i</span><span class="params">(list)</span></span>;</span><br><span class="line"><span class="keyword">while</span> (i.<span class="built_in">hasNext</span>()) &#123;</span><br><span class="line">   <span class="keyword">if</span> (i.<span class="built_in">next</span>() % <span class="number">2</span> != <span class="number">0</span>)</span><br><span class="line">      i.<span class="built_in">remove</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>remove()函数移除next()函数刚刚跳过的一个数据项，不会使迭代器失效。</p><p>setValue()函数可以修改刚刚跳过去的数据项的值。</p><h4 id="关联容器类的迭代器的使用"><a href="#关联容器类的迭代器的使用" class="headerlink" title="关联容器类的迭代器的使用"></a>关联容器类的迭代器的使用</h4><p>对于关联容器类QMap，使用QMapIterator和QMutableMapIterator迭代器类，它们具有表2所示的所有函数，主要是增加了key()和value()函数用于获取刚刚跳过的数据项的键和值。</p><p>例如，下面的代码将删除键（城市名称）里以“City”结尾的数据项。</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">QMap&lt;QString, QString&gt; map;</span><br><span class="line">map.<span class="built_in">insert</span>(<span class="string">&quot;Paris&quot;</span>, <span class="string">&quot;France&quot;</span>);</span><br><span class="line">map.<span class="built_in">insert</span>(<span class="string">&quot;New York&quot;</span>, <span class="string">&quot;USA&quot;</span>);</span><br><span class="line">map.<span class="built_in">insert</span>(<span class="string">&quot;Mexico City&quot;</span>, <span class="string">&quot;USA&quot;</span>);</span><br><span class="line">map.<span class="built_in">insert</span>(<span class="string">&quot;Moscow&quot;</span>, <span class="string">&quot;Russia&quot;</span>);</span><br><span class="line">...</span><br><span class="line"><span class="function">QMutableMapIterator&lt;QString, QString&gt; <span class="title">i</span><span class="params">(map)</span></span>;</span><br><span class="line"><span class="keyword">while</span> (i.<span class="built_in">hasNext</span>()) &#123;</span><br><span class="line">   <span class="keyword">if</span> (i.<span class="built_in">next</span>().<span class="built_in">key</span>().<span class="built_in">endsWith</span>(<span class="string">&quot;City&quot;</span>))</span><br><span class="line">      i.<span class="built_in">remove</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>如果是在多值容器里遍历，可以用findNext()或findPrevious()查找下一个或上一个值，如下面的代码将删除上一示例代码中map里值为“USA”的所有数据项。</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">QMutableMapIterator&lt;QString, QString&gt; <span class="title">i</span><span class="params">(map)</span></span>;</span><br><span class="line"><span class="keyword">while</span> (i.<span class="built_in">findNext</span>(<span class="string">&quot;USA&quot;</span>))</span><br><span class="line">   i.<span class="built_in">remove</span>();</span><br></pre></td></tr></table></figure><p>2.STL类型迭代器</p><p>STL迭代器与Qt和STL的原生算法兼容，并且进行了速度优化。具体类型见表3。</p><p>对于每一个容器类，都有两个STL类型迭代器：一个用于只读访问，一个用于读写访问。无需修改数据时一定使用只读迭代器，因为它们速度更快。</p><p>表3　STL类型的迭代器类</p><p>容器类 只读迭代器 读写迭代器<br>QList<t>, QQueue<t>QList<t>::const_iterator QList<t>::iterator<br>QLinkedList<t>QLinkedList<t>::const_iterator QLinkedList<t>::iterator<br>QVector<t>, QStack<t>QVector<t>::const_iterator QVector<t>::iterator<br>QSet<t>QSet<t>::const_iterator QSet<t>::iterator<br>QMap&lt;Key, T&gt;,QMultiMap&lt;Key, T&gt; QMap&lt;Key, T&gt;::const_iterator QMap&lt;Key, T&gt;::iterator<br>QHash&lt;Key, T&gt;,QMultiHash&lt;Key, T&gt; QHash&lt;Key, T&gt;::const_iterator QHash&lt;Key, T&gt;::iterator<br>注意　<br>在定义只读迭代器和读写迭代器时的区别，它们使用了不同的关键字，const_iterator定义只读迭代器，iterator定义读写迭代器。此外，还可以使用const_reverse_iterator和reverse_iterator定义相应的反向迭代器。</t></t></t></t></t></t></t></t></t></t></t></t></t></t></p><p>STL类型的迭代器是数组的指针，所以“++”运算符使迭代器指向下一个数据项，“*”运算符返回数据项内容。与Java类型的迭代器不同，STL迭代器直接指向数据项，STL迭代器指向位置示意图如图2所示。</p><p>begin()函数使迭代器指向容器的第一个数据项，end()函数使迭代器指向一个虚拟的表示结尾的数据项，end()表示的数据项是无效的，一般用作循环结束条件。</p><p>下面仍然以QList和QMap为例说明STL迭代器的用法，其他容器类迭代器的用法类似。</p><p>2．顺序容器类的迭代器的用法</p><p>下面的示例代码将QList list里的数据项逐项输出。</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">QList&lt;QString&gt; list;</span><br><span class="line">list &lt;&lt; <span class="string">&quot;A&quot;</span> &lt;&lt; <span class="string">&quot;B&quot;</span> &lt;&lt; <span class="string">&quot;C&quot;</span> &lt;&lt; <span class="string">&quot;D&quot;</span>;</span><br><span class="line">QList&lt;QString&gt;::const_iterator i;</span><br><span class="line"><span class="keyword">for</span> (i = list.<span class="built_in">constBegin</span>(); i != list.<span class="built_in">constEnd</span>(); ++i)</span><br><span class="line">   <span class="built_in">qDebug</span>() &lt;&lt; *i;</span><br></pre></td></tr></table></figure><p>constBegin()和constEnd()是用于只读迭代器的，表示起始和结束位置。</p><p>若使用反向读写迭代器，并将上面示例代码中list的数据项都改为小写，代码如下：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">QList&lt;QString&gt;::reverse_iterator i;</span><br><span class="line"><span class="keyword">for</span> (i = list.<span class="built_in">rbegin</span>(); i != list.<span class="built_in">rend</span>(); ++i)</span><br><span class="line">   *i = i-&gt;<span class="built_in">toLower</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>3．关联容器类的迭代器的用法</p><p>对于关联容器类QMap和QHash，迭代器的“*”操作符返回数据项的值。如果想返回键，使用key()函数。对应的，用value()函数返回一个项的值。</p><p>例如，下面的代码将QMap&lt;int, int&gt; map中所有项的键和值输出。</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">QMap&lt;<span class="type">int</span>, <span class="type">int</span>&gt; map;</span><br><span class="line">...</span><br><span class="line">QMap&lt;<span class="type">int</span>, <span class="type">int</span>&gt;::const_iterator i;</span><br><span class="line"><span class="keyword">for</span> (i = map.<span class="built_in">constBegin</span>(); i != map.<span class="built_in">constEnd</span>(); ++i)</span><br><span class="line">   <span class="built_in">qDebug</span>() &lt;&lt; i.<span class="built_in">key</span>() &lt;&lt; <span class="string">&#x27;:&#x27;</span> &lt;&lt; i.<span class="built_in">value</span>();</span><br></pre></td></tr></table></figure><p>Qt API包含很多返回值为QList或QStringList的函数，要遍历这些返回的容器，必须先复制。由于Qt使用了隐式共享，这样的复制并无多大开销。例如下面的代码是正确的。</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">const</span> QList&lt;<span class="type">int</span>&gt; sizes = splitter-&gt;<span class="built_in">sizes</span>();</span><br><span class="line">QList&lt;<span class="type">int</span>&gt;::const_iterator i;</span><br><span class="line"><span class="keyword">for</span> (i = sizes.<span class="built_in">begin</span>(); i != sizes.<span class="built_in">end</span>(); ++i)</span><br><span class="line">   ...</span><br></pre></td></tr></table></figure><p>提示：<br>隐式共享（Implicit Sharing）是对象的管理方法。一个对象被隐式共享，只是传递该对象的一个指针给使用者，而不实际复制对象数据，只有在使用者修改数据时，才实质复制共享对象给使用者。如在上面的代码中，splitter-&gt;sizes()返回的是一个QList列表对象sizes，但是实际上代码并不将splitter-&gt;sizes()表示的列表内容完全复制给变量sizes，只是传递给它一个指针。只有当sizes发生数据修改时，才会将共享对象的数据复制给sizes，这样避免了不必要的复制，减少了资源占用。</p><p>而下面的代码是错误的。</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">QList&lt;<span class="type">int</span>&gt;::const_iterator i;</span><br><span class="line"><span class="keyword">for</span> (i = splitter-&gt;<span class="built_in">sizes</span>().<span class="built_in">begin</span>(); i != splitter-&gt;<span class="built_in">sizes</span>().<span class="built_in">end</span>(); ++i)</span><br><span class="line">   ...</span><br></pre></td></tr></table></figure><p>对于STL类型的迭代器，隐式共享还涉及另外一个问题，即当有一个迭代器在操作一个容器变量时，不要去复制这个容器变量。</p><p>3.foreach关键字<br>如果只是想遍历容器中所有的项，可以使用foreach关键字。foreach是头文件中定义的一个宏。使用foreach的句法是：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">foreach (variable, container)</span><br></pre></td></tr></table></figure><p>使用foreach的代码比使用迭代器更简洁。例如，使用foreach遍历一个QLinkedList的示例代码如下：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">QLinkedList&lt;QString&gt; list;</span><br><span class="line">...</span><br><span class="line">QString str;</span><br><span class="line">foreach (str, list)</span><br><span class="line">   <span class="built_in">qDebug</span>() &lt;&lt; str;</span><br></pre></td></tr></table></figure><p>用于迭代的变量也可以在foreach语句里定义，foreach语句也可以使用花括号，可以使用break退出迭代，示例代码如下：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">QLinkedList&lt;QString&gt; list;</span><br><span class="line">...</span><br><span class="line">foreach (<span class="type">const</span> QString &amp;str, list) &#123;</span><br><span class="line">   <span class="keyword">if</span> (str.<span class="built_in">isEmpty</span>())</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">   <span class="built_in">qDebug</span>() &lt;&lt; str;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>对于QMap和QHash，foreach会自动访问“键——值”对里的值，所以无需调用values()。如果需要访问键则可以调用keys()，示例代码如下：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">QMap&lt;QString, <span class="type">int</span>&gt; map;</span><br><span class="line">...</span><br><span class="line">foreach (<span class="type">const</span> QString &amp;str, map.<span class="built_in">keys</span>())</span><br><span class="line">   <span class="built_in">qDebug</span>() &lt;&lt; str &lt;&lt; <span class="string">&#x27;:&#x27;</span> &lt;&lt; map.<span class="built_in">value</span>(str);</span><br></pre></td></tr></table></figure><p>对于多值映射，可以使用两重foreach语句，示例代码如下：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">QMultiMap&lt;QString, <span class="type">int</span>&gt; map;</span><br><span class="line">...</span><br><span class="line">foreach (<span class="type">const</span> QString &amp;str, map.<span class="built_in">uniqueKeys</span>()) &#123;</span><br><span class="line">   foreach (<span class="type">int</span> i, map.<span class="built_in">values</span>(str))</span><br><span class="line">      <span class="built_in">qDebug</span>() &lt;&lt; str &lt;&lt; <span class="string">&#x27;:&#x27;</span> &lt;&lt; i;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>注意：<br>foreach关键字遍历一个容器变量是创建了容器的一个副本，所以不能修改原来容器变量的数据项。</p><h3 id="文件读写"><a href="#文件读写" class="headerlink" title="文件读写"></a>文件读写</h3><p>Qt文件读写<br>在Qt中进行文件读写通常使用QFile和QTextStream类。<br>首先你需要在项目中添加以下头文件：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QFile&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QTextStream&gt;</span></span></span><br></pre></td></tr></table></figure><p>QFile是Qt中用于读写文件的一个类，提供了丰富的函数接口来进行文件操作。下面是QFile的主要函数原型以及它们的返回值：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 打开和关闭文件</span></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">open</span><span class="params">(OpenMode flags)</span></span>; <span class="comment">// 打开文件，flags表示打开模式</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">close</span><span class="params">()</span></span>; <span class="comment">// 关闭文件</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 读写文件</span></span><br><span class="line"><span class="function">qint64 <span class="title">read</span><span class="params">(<span class="type">char</span> *data, qint64 len)</span></span>; <span class="comment">// 读取文件内容到data缓存区，最多读取len个字节，返回实际读取的字节数</span></span><br><span class="line"><span class="function">qint64 <span class="title">write</span><span class="params">(<span class="type">const</span> <span class="type">char</span> *data, qint64 len)</span></span>;<span class="comment">//将data缓存区中的内容写入文件，最多写入len个字节，返回实际写入的字节数</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 文件指针</span></span><br><span class="line"><span class="function">qint64 <span class="title">pos</span><span class="params">()</span> <span class="type">const</span></span>; <span class="comment">// 返回当前文件读写位置</span></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">seek</span><span class="params">(qint64 pos)</span></span>; <span class="comment">// 设置文件读写位置，文件指针置于pos位置，返回是否设置成功</span></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">atEnd</span><span class="params">()</span> <span class="type">const</span></span>; <span class="comment">// 判断是否到达文件末尾</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 文件信息</span></span><br><span class="line"><span class="function">QString <span class="title">fileName</span><span class="params">()</span> <span class="type">const</span></span>; <span class="comment">// 返回文件名字</span></span><br><span class="line"><span class="function">qint64 <span class="title">size</span><span class="params">()</span> <span class="type">const</span></span>; <span class="comment">// 返回文件大小</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 错误处理和状态判断</span></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">isReadable</span><span class="params">()</span> <span class="type">const</span></span>; <span class="comment">// 判断文件是否可读</span></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">isWritable</span><span class="params">()</span> <span class="type">const</span></span>; <span class="comment">// 判断文件是否可写</span></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">isOpen</span><span class="params">()</span> <span class="type">const</span></span>; <span class="comment">// 判断文件是否已经打开</span></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">isError</span><span class="params">()</span> <span class="type">const</span></span>; <span class="comment">// 判断文件读写过程中是否出错</span></span><br><span class="line"><span class="function">QFileDevice::FileError <span class="title">error</span><span class="params">()</span> <span class="type">const</span></span>; <span class="comment">// 判断文件读写过程中的错误类型</span></span><br></pre></td></tr></table></figure><p>QTextStream是Qt中一个方便的文本读写类，用于对文本内容进行读写操作。它支持各种文本编码格式，并且自动处理了换行符等特殊字符。下面是QTextStream中一些常用的函数原型，以及它们的返回值：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 构造函数和析构函数</span></span><br><span class="line"><span class="built_in">QTextStream</span>(); <span class="comment">// 默认构造函数</span></span><br><span class="line"><span class="built_in">QTextStream</span>(QIODevice *device); <span class="comment">// 使用I/O设备device构造QTextStream对象</span></span><br><span class="line">~<span class="built_in">QTextStream</span>(); <span class="comment">// 析构函数</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 读写操作</span></span><br><span class="line">QTextStream &amp;<span class="keyword">operator</span>&lt;&lt;(<span class="type">bool</span> value); <span class="comment">// 写入bool类型数据</span></span><br><span class="line">QTextStream &amp;<span class="keyword">operator</span>&lt;&lt;(<span class="type">char</span> value); <span class="comment">// 写入char类型数据</span></span><br><span class="line">QTextStream &amp;<span class="keyword">operator</span>&lt;&lt;(<span class="type">short</span> value); <span class="comment">// 写入short类型数据</span></span><br><span class="line">QTextStream &amp;<span class="keyword">operator</span>&lt;&lt;(ushort value); <span class="comment">// 写入ushort类型数据</span></span><br><span class="line">QTextStream &amp;<span class="keyword">operator</span>&lt;&lt;(<span class="type">int</span> value); <span class="comment">// 写入int类型数据</span></span><br><span class="line">QTextStream &amp;<span class="keyword">operator</span>&lt;&lt;(uint value); <span class="comment">// 写入uint类型数据</span></span><br><span class="line">QTextStream &amp;<span class="keyword">operator</span>&lt;&lt;(<span class="type">long</span> value); <span class="comment">// 写入long类型数据</span></span><br><span class="line">QTextStream &amp;<span class="keyword">operator</span>&lt;&lt;(ulong value); <span class="comment">// 写入ulong类型数据</span></span><br><span class="line">QTextStream &amp;<span class="keyword">operator</span>&lt;&lt;(qint64 value); <span class="comment">// 写入qint64类型数据</span></span><br><span class="line">QTextStream &amp;<span class="keyword">operator</span>&lt;&lt;(quint64 value); <span class="comment">// 写入quint64类型数据</span></span><br><span class="line">QTextStream &amp;<span class="keyword">operator</span>&lt;&lt;(<span class="type">float</span> value); <span class="comment">// 写入float类型数据</span></span><br><span class="line">QTextStream &amp;<span class="keyword">operator</span>&lt;&lt;(<span class="type">double</span> value); <span class="comment">// 写入double类型数据</span></span><br><span class="line">QTextStream &amp;<span class="keyword">operator</span>&lt;&lt;(<span class="type">const</span> <span class="type">char</span> *value); <span class="comment">// 写入C字符串数据</span></span><br><span class="line">QTextStream &amp;<span class="keyword">operator</span>&lt;&lt;(<span class="type">const</span> QString &amp;value); <span class="comment">// 写入QString数据</span></span><br><span class="line">QTextStream &amp;<span class="keyword">operator</span>&gt;&gt;(<span class="type">bool</span> &amp;value); <span class="comment">// 读取bool类型数据</span></span><br><span class="line">QTextStream &amp;<span class="keyword">operator</span>&gt;&gt;(<span class="type">char</span> &amp;value); <span class="comment">// 读取char类型数据</span></span><br><span class="line">QTextStream &amp;<span class="keyword">operator</span>&gt;&gt;(<span class="type">short</span> &amp;value); <span class="comment">// 读取short类型数据</span></span><br><span class="line">QTextStream &amp;<span class="keyword">operator</span>&gt;&gt;(ushort &amp;value); <span class="comment">// 读取ushort类型数据</span></span><br><span class="line">QTextStream &amp;<span class="keyword">operator</span>&gt;&gt;(<span class="type">int</span> &amp;value); <span class="comment">// 读取int类型数据</span></span><br><span class="line">QTextStream &amp;<span class="keyword">operator</span>&gt;&gt;(uint &amp;value); <span class="comment">// 读取uint类型数据</span></span><br><span class="line">QTextStream &amp;<span class="keyword">operator</span>&gt;&gt;(<span class="type">long</span> &amp;value); <span class="comment">// 读取long类型数据</span></span><br><span class="line">QTextStream &amp;<span class="keyword">operator</span>&gt;&gt;(ulong &amp;value); <span class="comment">// 读取ulong类型数据</span></span><br><span class="line">QTextStream &amp;<span class="keyword">operator</span>&gt;&gt;(qint64 &amp;value); <span class="comment">// 读取qint64类型数据</span></span><br><span class="line">QTextStream &amp;<span class="keyword">operator</span>&gt;&gt;(quint64 &amp;value); <span class="comment">// 读取quint64类型数据</span></span><br><span class="line">QTextStream &amp;<span class="keyword">operator</span>&gt;&gt;(<span class="type">float</span> &amp;value); <span class="comment">// 读取float类型数据</span></span><br><span class="line">QTextStream &amp;<span class="keyword">operator</span>&gt;&gt;(<span class="type">double</span> &amp;value); <span class="comment">// 读取double类型数据</span></span><br><span class="line">QTextStream &amp;<span class="keyword">operator</span>&gt;&gt;(QString &amp;value); <span class="comment">// 读取字符串数据</span></span><br><span class="line"><span class="function">QString <span class="title">readLine</span><span class="params">()</span></span>; <span class="comment">// 读取一行字符串</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 错误处理和状态判断</span></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">atEnd</span><span class="params">()</span> <span class="type">const</span></span>; <span class="comment">// 判断是否到达文本末尾</span></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">ok</span><span class="params">()</span> <span class="type">const</span></span>; <span class="comment">// 判断读写操作是否成功</span></span><br></pre></td></tr></table></figure><p>下面是一个示例代码，写入一个字符串到文件中;</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">QFile <span class="title">file</span><span class="params">(<span class="string">&quot;example.txt&quot;</span>)</span></span>; <span class="comment">// 将example.txt文件与file对象关联</span></span><br><span class="line"><span class="keyword">if</span> (file.<span class="built_in">open</span>(QIODevice::WriteOnly | QIODevice::Text)) &#123; <span class="comment">// 指定文件的打开模式</span></span><br><span class="line">    <span class="function">QTextStream <span class="title">outStream</span><span class="params">(&amp;file)</span></span>; <span class="comment">// 用QTextStream对象向文件中写入数据</span></span><br><span class="line">    <span class="function">QString <span class="title">str</span><span class="params">(<span class="string">&quot;Hello, World!&quot;</span>)</span></span>; <span class="comment">// 要写入的字符串</span></span><br><span class="line">    outStream &lt;&lt; str &lt;&lt; endl; <span class="comment">// 写入字符串，并添加一个换行符</span></span><br><span class="line">    file.<span class="built_in">close</span>(); <span class="comment">// 关闭文件</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>下面是一个从文件中读取内容的示例，假设example.txt文件中有文本内容：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">QFile <span class="title">file</span><span class="params">(<span class="string">&quot;example.txt&quot;</span>)</span></span>; <span class="comment">// 将example.txt文件与file对象关联</span></span><br><span class="line"><span class="keyword">if</span> (file.<span class="built_in">open</span>(QIODevice::ReadOnly | QIODevice::Text)) &#123; <span class="comment">// 指定文件的打开模式</span></span><br><span class="line">    <span class="function">QTextStream <span class="title">inStream</span><span class="params">(&amp;file)</span></span>; <span class="comment">// 用QTextStream对象从文件中读取数据</span></span><br><span class="line">    QString str = inStream.<span class="built_in">readAll</span>(); <span class="comment">// 读取所有的字符串内容</span></span><br><span class="line">    file.<span class="built_in">close</span>(); <span class="comment">// 关闭文件</span></span><br><span class="line">    <span class="built_in">qDebug</span>() &lt;&lt; <span class="string">&quot;Content of the file is: &quot;</span> &lt;&lt; str; <span class="comment">// 在Debug控制台输出读取到的内容</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>QFile 是 Qt 中用来读写文件的类，它的定义位于QFile模块中，同时还有一些其他用于文件读写的类和函数。<br>为了使用QFile类，需要在代码中添加头文件QFile。下面是一个QFile读写文件的示例：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QFile&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QDebug&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">writeToFile</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// 1.创建QFile实例，并打开文件</span></span><br><span class="line">    <span class="function">QFile <span class="title">file</span><span class="params">(<span class="string">&quot;example.txt&quot;</span>)</span></span>;</span><br><span class="line">    <span class="keyword">if</span> (file.<span class="built_in">open</span>(QIODevice::WriteOnly | QIODevice::Text)) &#123; <span class="comment">// 只写模式打开文件</span></span><br><span class="line">        <span class="comment">// 2.使用QTextStream写入数据</span></span><br><span class="line">        <span class="function">QTextStream <span class="title">out</span><span class="params">(&amp;file)</span></span>;</span><br><span class="line">        out &lt;&lt; <span class="string">&quot;Hello, QFile! Write some characters.&quot;</span> &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 3.关闭文件</span></span><br><span class="line">        file.<span class="built_in">close</span>();       </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">readFromFile</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// 1.创建QFile实例，并打开文件</span></span><br><span class="line">    <span class="function">QFile <span class="title">file</span><span class="params">(<span class="string">&quot;example.txt&quot;</span>)</span></span>;</span><br><span class="line">    <span class="keyword">if</span> (file.<span class="built_in">open</span>(QIODevice::ReadOnly | QIODevice::Text)) &#123; <span class="comment">// 只读模式打开文件</span></span><br><span class="line">        <span class="comment">// 2.使用QTextStream读取数据</span></span><br><span class="line">        <span class="function">QTextStream <span class="title">in</span><span class="params">(&amp;file)</span></span>;</span><br><span class="line">        QString line = in.<span class="built_in">readLine</span>();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 3.循环读取数据</span></span><br><span class="line">        <span class="keyword">while</span> (!line.<span class="built_in">isNull</span>()) &#123;</span><br><span class="line">            <span class="comment">// 4.输出到控制台</span></span><br><span class="line">            <span class="built_in">qDebug</span>() &lt;&lt; line;</span><br><span class="line">            <span class="comment">// 5.获取下一行数据</span></span><br><span class="line">            line = in.<span class="built_in">readLine</span>();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 6.关闭文件</span></span><br><span class="line">        file.<span class="built_in">close</span>();       </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>以上代码包括如下步骤：<br>1.使用QFile打开文件，使用QIODevice::ReadOnly或QIODevice::WriteOnly定义打开模式。<br>2.使用QTextStream写入&#x2F;读取文件数据。<br>3.关闭文件。</p><p>在这个例子中，为了演示QFile的读写操作，我们首先使用QFile创建了一个example.txt文件并写入了一行字符，然后又使用QFile读取了这个文件的内容并输出到控制台。</p><p>需要注意的是，QFile的操作可能会抛出异常和错误，因此在代码中必须处理异常和错误。在这个示例中，我们使用了QIODevice::ReadOnly和QIODevice::WriteOnly两种打开模式，用于指定只读或只写文件。</p><p>QFile中关于QIODevice的宏定义<br>QFile是一个通用的文件读写类，它继承自QIODevice，QIODevice是一个用于读写I&#x2F;O设备的抽象类，提供了许多文件读写的方法。QFile使用QIODevice提供的方法实现文件的读写，QIODevice中定义了一些与文件读写相关的宏定义，下面分别介绍一下这些宏定义的作用：</p><ul><li>QIODevice::ReadOnly：只读模式，打开文件时使用，只能进行读操作。</li><li>QIODevice::WriteOnly：只写模式，打开文件时使用，只能进行写操作。</li><li>QIODevice::ReadWrite：可读写模式，打开文件时使用，既可以进行读操作，也可以进行写操作。</li><li>QIODevice::Append：追加模式，打开文件时使用，如果文件已存在，则在文件末尾追加内容。</li><li>QIODevice::Truncate：截断模式，打开文件时使用，如果文件已存在，将清空文件的内容。</li><li>QIODevice::Text：文本模式，打开文件时使用，使用文本流进行读写，自动进行换行符的转换，例如在Windows系统中使用”\r\n”表示换行，而在Unix&#x2F;Linux系统中使用”\n”表示换行。</li><li>QIODevice::Unbuffered：无缓冲模式，使用QFile操作文件默认开启缓冲，使用该宏定义则禁用缓冲。</li></ul><p>这些宏定义都是 QIODevice 中的枚举值，可以根据需要使用它们来指定 QFile 对象的打开模式。例如，如果你想以只读方式打开文件，则可以使用以下语句创建 QFile 对象：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">QFile <span class="title">file</span><span class="params">(<span class="string">&quot;example.txt&quot;</span>)</span></span>;</span><br><span class="line"><span class="keyword">if</span> (file.<span class="built_in">open</span>(QIODevice::ReadOnly | QIODevice::Text)) &#123;</span><br><span class="line">    <span class="comment">// 文件已打开并可供读操作</span></span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="正则表达式"><a href="#正则表达式" class="headerlink" title="正则表达式"></a>正则表达式</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//匹配字符</span></span><br><span class="line"><span class="function">QRegExp <span class="title">ret</span><span class="params">(<span class="string">&quot;a&quot;</span>)</span></span>;</span><br><span class="line"><span class="built_in">qDebug</span>() &lt;&lt; <span class="string">&quot;是否匹配成功: &quot;</span> &lt;&lt; ret.<span class="built_in">exactMatch</span>(<span class="string">&quot;abc&quot;</span>);    <span class="comment">//false</span></span><br><span class="line"><span class="built_in">qDebug</span>() &lt;&lt; <span class="string">&quot;是否匹配成功: &quot;</span> &lt;&lt; ret.<span class="built_in">exactMatch</span>(<span class="string">&quot;a&quot;</span>);      <span class="comment">//true</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//匹配数字</span></span><br><span class="line"><span class="function">QRegExp <span class="title">retNum</span><span class="params">(<span class="string">&quot;(\\d*\\D&#123;2&#125;)&quot;</span>)</span></span>;</span><br><span class="line"><span class="built_in">qDebug</span>() &lt;&lt; <span class="string">&quot;是否匹配成功: &quot;</span> &lt;&lt; retNum.<span class="built_in">exactMatch</span>(<span class="string">&quot;120kg&quot;</span>);    <span class="comment">//true</span></span><br><span class="line"><span class="built_in">qDebug</span>() &lt;&lt; <span class="string">&quot;是否匹配成功: &quot;</span> &lt;&lt; retNum.<span class="built_in">exactMatch</span>(<span class="string">&quot;180cm&quot;</span>);    <span class="comment">//true</span></span><br><span class="line"><span class="built_in">qDebug</span>() &lt;&lt; <span class="string">&quot;是否匹配成功: &quot;</span> &lt;&lt; retNum.<span class="built_in">exactMatch</span>(<span class="string">&quot;3M&quot;</span>);       <span class="comment">//false</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//匹配通配符</span></span><br><span class="line"><span class="function">QRegExp <span class="title">re</span><span class="params">(<span class="string">&quot;*.txt&quot;</span>)</span> </span>;</span><br><span class="line">re.<span class="built_in">setPatternSyntax</span>(QRegExp::Wildcard); <span class="comment">//支持通配符</span></span><br><span class="line"><span class="built_in">qDebug</span>() &lt;&lt; <span class="string">&quot;通配符匹配: &quot;</span> &lt;&lt; re.<span class="built_in">exactMatch</span>(<span class="string">&quot;a.txt&quot;</span>);         <span class="comment">//true</span></span><br><span class="line"><span class="built_in">qDebug</span>() &lt;&lt; <span class="string">&quot;通配符匹配: &quot;</span> &lt;&lt; re.<span class="built_in">exactMatch</span>(<span class="string">&quot;a.txt.bak&quot;</span>);     <span class="comment">//false</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//匹配单词边界</span></span><br><span class="line"><span class="function">QRegExp <span class="title">reg</span><span class="params">(<span class="string">&quot;\\b(hello|Hello)\\b&quot;</span>)</span></span>;</span><br><span class="line"><span class="built_in">qDebug</span>() &lt;&lt; <span class="string">&quot;多个单词匹配: &quot;</span> &lt;&lt; reg.<span class="built_in">indexIn</span>(<span class="string">&quot;helloEveryone&quot;</span>);     <span class="comment">//-1表示失败</span></span><br><span class="line"><span class="built_in">qDebug</span>() &lt;&lt; <span class="string">&quot;多个单词匹配: &quot;</span> &lt;&lt; reg.<span class="built_in">indexIn</span>(<span class="string">&quot;Hmm Hello Everyone&quot;</span>);<span class="comment">//4 表示匹配到的字符位置</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//匹配捕获的文本</span></span><br><span class="line"><span class="comment">//以 &quot;(?:&quot; 开始, 以 &quot;)&quot; 结束</span></span><br><span class="line"><span class="function">QRegExp <span class="title">regHeight</span><span class="params">(<span class="string">&quot;(\\d+)(?:\\s*)(cm|inch)&quot;</span>)</span></span>;</span><br><span class="line"><span class="type">int</span> res = regHeight.<span class="built_in">indexIn</span>(<span class="string">&quot;zhangsan 170cm&quot;</span>);</span><br><span class="line"><span class="keyword">if</span>(res &gt; <span class="number">-1</span>)&#123;</span><br><span class="line"><span class="built_in">qDebug</span>() &lt;&lt; <span class="string">&quot;regHeight(0):&quot;</span> &lt;&lt; regHeight.<span class="built_in">cap</span>(<span class="number">0</span>);    <span class="comment">//170cm</span></span><br><span class="line"><span class="built_in">qDebug</span>() &lt;&lt; <span class="string">&quot;regHeight(1):&quot;</span> &lt;&lt; regHeight.<span class="built_in">cap</span>(<span class="number">1</span>);    <span class="comment">//170</span></span><br><span class="line"><span class="built_in">qDebug</span>() &lt;&lt; <span class="string">&quot;regHeight(2):&quot;</span> &lt;&lt; regHeight.<span class="built_in">cap</span>(<span class="number">2</span>);    <span class="comment">//cm</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//断言 (?!) 表示:不紧跟才能匹配</span></span><br><span class="line"><span class="function">QRegExp <span class="title">regAssertFalse</span><span class="params">(<span class="string">&quot;面(?!包)&quot;</span>)</span></span>;</span><br><span class="line">QString str = <span class="string">&quot;面包没了,只剩面条了&quot;</span>;</span><br><span class="line">str.<span class="built_in">replace</span>(regAssertFalse, <span class="string">&quot;龙虾鲍鱼&quot;</span>);</span><br><span class="line"><span class="built_in">qDebug</span>() &lt;&lt; str;    <span class="comment">//输出: &quot;面包没了,只剩龙虾鲍鱼了&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//断言 (?=) 表示:紧跟才匹配</span></span><br><span class="line"><span class="function">QRegExp <span class="title">regAssertTrue</span><span class="params">(<span class="string">&quot;面(?=包)&quot;</span>)</span></span>;</span><br><span class="line">QString str1 = <span class="string">&quot;面包没了,只剩面条了&quot;</span>;</span><br><span class="line">str1.<span class="built_in">replace</span>(regAssertTrue, <span class="string">&quot;草&quot;</span>);</span><br><span class="line"><span class="built_in">qDebug</span>() &lt;&lt; str1;    <span class="comment">//输出: &quot;龙虾鲍鱼没了,只剩面条了&quot;</span></span><br></pre></td></tr></table></figure><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Qt5新类</span></span><br><span class="line"><span class="function">QRegularExpression <span class="title">regExp</span><span class="params">(<span class="string">&quot;hello&quot;</span>)</span></span>;</span><br><span class="line"><span class="built_in">qDebug</span>() &lt;&lt; <span class="string">&quot;QRegularExpression匹配字符: &quot;</span> &lt;&lt;regExp.<span class="built_in">match</span>(<span class="string">&quot;hello world&quot;</span>); <span class="comment">//输出(0, 5, &quot;hello&quot;)</span></span><br><span class="line"></span><br><span class="line">regExp.<span class="built_in">setPattern</span>(<span class="string">&quot;([A-Z]&#123;3,8&#125;)&quot;</span>);</span><br><span class="line">regExp.<span class="built_in">setPatternOptions</span>(QRegularExpression::CaseInsensitiveOption);    <span class="comment">//大小写不敏感</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">qDebug</span>() &lt;&lt; <span class="string">&quot;大小写不敏感匹配字符: &quot;</span> &lt;&lt;regExp.<span class="built_in">match</span>(<span class="string">&quot;hello&quot;</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//新类捕获匹配</span></span><br><span class="line"><span class="function">QRegularExpression <span class="title">regExp1</span><span class="params">(<span class="string">&quot;^(\\d\\d\\d\\d)/(\\d\\d)/(\\d\\d)$&quot;</span>)</span></span>;</span><br><span class="line">QRegularExpressionMatch match0 = regExp1.<span class="built_in">match</span>(<span class="string">&quot;2022/04/04&quot;</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(match0.<span class="built_in">isValid</span>())&#123;</span><br><span class="line">    QString strMatch0 = match0.<span class="built_in">captured</span>(<span class="number">0</span>);</span><br><span class="line">    QString year = match0.<span class="built_in">captured</span>(<span class="number">1</span>);</span><br><span class="line">    QString month = match0.<span class="built_in">captured</span>(<span class="number">2</span>);</span><br><span class="line">    QString day = match0.<span class="built_in">captured</span>(<span class="number">3</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">qDebug</span>() &lt;&lt; <span class="string">&quot;日期: &quot;</span> &lt;&lt; strMatch0;</span><br><span class="line">    <span class="built_in">qDebug</span>() &lt;&lt; <span class="string">&quot;年: &quot;</span> &lt;&lt; year;</span><br><span class="line">    <span class="built_in">qDebug</span>() &lt;&lt; <span class="string">&quot;月: &quot;</span> &lt;&lt; month;</span><br><span class="line">    <span class="built_in">qDebug</span>() &lt;&lt; <span class="string">&quot;日: &quot;</span> &lt;&lt; day;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">QString sPattern;</span><br><span class="line">sPattern = <span class="string">&quot;^(Jan|Feb|Mar|Apr|May) \\d\\d \\d\\d\\d\\d$&quot;</span>;</span><br><span class="line"><span class="function">QRegularExpression <span class="title">regDate</span><span class="params">(sPattern)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function">QString <span class="title">ss</span><span class="params">(<span class="string">&quot;Feb 02 2022&quot;</span>)</span></span>;</span><br><span class="line">QRegularExpressionMatch dateMatch;</span><br><span class="line">dateMatch = regDate.<span class="built_in">match</span>(ss, <span class="number">0</span>,</span><br><span class="line">                            QRegularExpression::PartialPreferCompleteMatch); <span class="comment">//部分匹配</span></span><br><span class="line"><span class="type">bool</span> b_HasMatched = dateMatch.<span class="built_in">hasMatch</span>();        <span class="comment">//完整匹配的返回值</span></span><br><span class="line"><span class="type">bool</span> b_Partial = dateMatch.<span class="built_in">hasPartialMatch</span>();    <span class="comment">//部分匹配的返回值</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">qDebug</span>() &lt;&lt; b_HasMatched;</span><br><span class="line"><span class="built_in">qDebug</span>() &lt;&lt; b_Partial;</span><br></pre></td></tr></table></figure><h3 id="枚举"><a href="#枚举" class="headerlink" title="枚举"></a>枚举</h3><p>枚举类型</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Enum</span> : <span class="keyword">public</span> QObject&#123;</span><br><span class="line">    Q_OBJECT</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="keyword">enum</span> <span class="title class_">Fruit</span>&#123;</span><br><span class="line">        APPLE = <span class="number">0</span>,</span><br><span class="line">        BANANA,</span><br><span class="line">        POTATO</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">Q_ENUM</span>(Fruit);<span class="comment">//向Qt注册此枚举文件，若有多个枚举，则在对应枚举下注册即可</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">enum</span> <span class="title class_">Vagetables</span>&#123;</span><br><span class="line">        TOMATO,<span class="comment">//默认初值从零起</span></span><br><span class="line">        ONION,</span><br><span class="line">        POTATO</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">Q_ENUM</span>(Vagetables);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>值转枚举</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> fruitType = <span class="number">0</span>;</span><br><span class="line">Enum::Fruit fruit = (Enum::Fruit)fruitType;</span><br><span class="line"><span class="comment">// Enum本身还是数值型的，所以只需要直接强制类型转换即可。但是我没有试过枚举不存在的值强制转换成枚举会是什么</span></span><br></pre></td></tr></table></figure><p>值转枚举项的字符（Value to key）</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QMetaEnum&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> fruitType = <span class="number">0</span>;</span><br><span class="line">QMetaEnum meta = QMetaEnum::<span class="built_in">fromType</span>&lt;Enum::Fruit&gt;();</span><br><span class="line">QString itemKey = meta.<span class="built_in">valueToKey</span>(fruitType);</span><br></pre></td></tr></table></figure><p>字符串转枚举值，结果为数字（Key to Value）</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">QString fruit = <span class="string">&quot;POTATO&quot;</span>;</span><br><span class="line">QMetaEnum meta = QMetaEnum::<span class="built_in">fromType</span>&lt;Enum::Fruit&gt;();</span><br><span class="line"><span class="type">int</span> value = meta.<span class="built_in">KeyToValue</span>(fruit.<span class="built_in">toStdString</span>().<span class="built_in">data</span>());<span class="comment">//入参是char *</span></span><br></pre></td></tr></table></figure><p>字符串转枚举类型，结果为枚举</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">QString fruit = <span class="string">&quot;POTATO&quot;</span>;</span><br><span class="line">QMetaEnum meta = QMetaEnum::<span class="built_in">fromType</span>&lt;Enum::Fruit&gt;();</span><br><span class="line">Enum::Fruit fruitItem = (Enum::Fruit)meta.<span class="built_in">KeyToValue</span>(fruit.<span class="built_in">toStdString</span>().<span class="built_in">data</span>());<span class="comment">//入参是char *</span></span><br></pre></td></tr></table></figure><h2 id="CLION"><a href="#CLION" class="headerlink" title="CLION"></a>CLION</h2><p><a target="_blank" rel="noopener" href="https://juejin.cn/post/7184793007302901820">https://juejin.cn/post/7184793007302901820</a></p><h2 id="并发编程"><a href="#并发编程" class="headerlink" title="并发编程"></a>并发编程</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 此程序用于演示共享内存的基本用法</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/ipc.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/shm.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> shmid;  <span class="comment">// 共享内存标识符</span></span><br><span class="line">    <span class="comment">// 创建共享内存，键值 0x5005，1024 字节，用 ipcs -m 命令可查看</span></span><br><span class="line">    <span class="keyword">if</span> ((shmid = <span class="built_in">shmget</span>((<span class="type">key_t</span>)<span class="number">0x5005</span>, <span class="number">1024</span>, <span class="number">0640</span>|IPC_CREAT)) == <span class="number">-1</span>) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;shmat(0x5005) failed\n&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">char</span> *ptext = <span class="number">0</span>;    <span class="comment">// 用于指向共享内存的指针</span></span><br><span class="line">    <span class="comment">// 将共享内存连接到当前进程的地址空间，由 ptext 指针指向它</span></span><br><span class="line">    ptext = (<span class="type">char</span> *)<span class="built_in">shmat</span>(shmid, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">    <span class="comment">// 操作本程序的 ptext 指针，就是操作共享内存</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;写入前：%s\n&quot;</span>, ptext);</span><br><span class="line">    <span class="built_in">sprintf</span>(ptext, <span class="string">&quot;本程序的进程号是：%d&quot;</span>, <span class="built_in">getpid</span>());</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;写入后：%s\n&quot;</span>, ptext);</span><br><span class="line">    <span class="comment">// 把共享内存从当前进程中分离</span></span><br><span class="line">    <span class="built_in">shmdt</span>(ptext);</span><br><span class="line">    <span class="comment">// 删除共享内存</span></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    if (shmctl(shmid, IPC_RMID, 0) == -1) &#123;</span></span><br><span class="line"><span class="comment">        printf(&quot;shmctl(0x5005) failed\n&quot;);</span></span><br><span class="line"><span class="comment">        return -1;</span></span><br><span class="line"><span class="comment">    &#125;</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 此程序用于演示信号量的使用方法</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;errno.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/ipc.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/sem.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">CSEM</span> &#123;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="comment">// 用于信号灯操作的共同体</span></span><br><span class="line">    <span class="keyword">union</span> <span class="title class_">semun</span>&#123;</span><br><span class="line">        <span class="type">int</span> val;</span><br><span class="line">        <span class="keyword">struct</span> <span class="title class_">semid_ds</span> *buf;</span><br><span class="line">        <span class="type">unsigned</span> <span class="type">short</span> *arry;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="type">int</span> sem_id;     <span class="comment">// 信号灯描述符</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">init</span><span class="params">(<span class="type">key_t</span> key)</span></span>;   <span class="comment">// 如果信号灯已存在，获取信号灯，如果不存在，则创建信号灯</span></span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">wait</span><span class="params">()</span></span>;            <span class="comment">// 等待信号灯挂出</span></span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">post</span><span class="params">()</span></span>;            <span class="comment">// 挂出信号灯</span></span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">destroy</span><span class="params">()</span></span>;         <span class="comment">// 销毁信号灯</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> *argv[])</span> </span>&#123;</span><br><span class="line">    CSEM sem;</span><br><span class="line">    <span class="comment">// 初始化信号灯</span></span><br><span class="line">    <span class="keyword">if</span> (sem.<span class="built_in">init</span>(<span class="number">0x5000</span>) == <span class="literal">false</span>) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;sem.init failed \n&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;sem.init ok\n&quot;</span>);</span><br><span class="line">    <span class="comment">// 等待信号灯挂出，等待成功后，将持有锁</span></span><br><span class="line">    <span class="keyword">if</span> (sem.<span class="built_in">wait</span>() == <span class="literal">false</span>) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;sem.wait failed. \n&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;sem.wait ok\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;sleep 10s...\n&quot;</span>);</span><br><span class="line">    <span class="built_in">sleep</span>(<span class="number">10</span>);      <span class="comment">// 在sleep的过程中，运行其他的程序将等待锁</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 挂出信号灯，释放锁。</span></span><br><span class="line">    <span class="keyword">if</span> (sem.<span class="built_in">post</span>() == <span class="literal">false</span>)  &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;post failed \n&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;post ok\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 销毁信号灯</span></span><br><span class="line">    <span class="comment">//if (sem.destroy() == false) &#123;</span></span><br><span class="line">    <span class="comment">//    printf(&quot;destroy failed\n&quot;);</span></span><br><span class="line">    <span class="comment">//    return -1;</span></span><br><span class="line">    <span class="comment">//&#125;</span></span><br><span class="line">    <span class="comment">//printf(&quot;destroy ok\n&quot;);</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">CSEM::init</span><span class="params">(<span class="type">key_t</span> key)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 获取信号灯</span></span><br><span class="line">    <span class="keyword">if</span> ((sem_id=<span class="built_in">semget</span>(key, <span class="number">1</span>, <span class="number">0640</span>)) == <span class="number">-1</span>) &#123;</span><br><span class="line">        <span class="comment">// 如果信号灯不存在，则创建</span></span><br><span class="line">        <span class="keyword">if</span> (errno == <span class="number">2</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> ((sem_id=<span class="built_in">semget</span>(key, <span class="number">1</span>, <span class="number">0640</span>|IPC_CREAT)) == <span class="number">-1</span>) &#123;</span><br><span class="line">                <span class="built_in">perror</span>(<span class="string">&quot;init 1 semget&quot;</span>);</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// 信号灯创建成功后，还需要把它初始化成可用的状态</span></span><br><span class="line">            <span class="keyword">union</span> <span class="title class_">semun</span> sem_union;</span><br><span class="line">            sem_union.val = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span> (<span class="built_in">semctl</span>(sem_id, <span class="number">0</span>, SETVAL, sem_union) &lt; <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="built_in">perror</span>(<span class="string">&quot;init semctl()&quot;</span>);</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="built_in">perror</span>(<span class="string">&quot;init 2 semget()&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">CSEM::destroy</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">semctl</span>(sem_id, <span class="number">0</span>, IPC_RMID) == <span class="number">-1</span>) &#123;</span><br><span class="line">        <span class="built_in">perror</span>(<span class="string">&quot;destory semctl&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">CSEM::wait</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">sembuf</span> sem_b;</span><br><span class="line">    sem_b.sem_num = <span class="number">0</span>;</span><br><span class="line">    sem_b.sem_op = <span class="number">-1</span>;</span><br><span class="line">    sem_b.sem_flg = SEM_UNDO;</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">semop</span>(sem_id, &amp;sem_b, <span class="number">1</span>) == <span class="number">-1</span>) &#123;</span><br><span class="line">        <span class="built_in">perror</span>(<span class="string">&quot;wait semop()&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">CSEM::post</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">sembuf</span> sem_b;</span><br><span class="line">    sem_b.sem_num = <span class="number">0</span>;</span><br><span class="line">    sem_b.sem_op = <span class="number">1</span>;</span><br><span class="line">    sem_b.sem_flg = SEM_UNDO;</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">semop</span>(sem_id, &amp;sem_b, <span class="number">1</span>) == <span class="number">-1</span>) &#123;</span><br><span class="line">        <span class="built_in">perror</span>(<span class="string">&quot;post semop()&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/junxuezheng/category_12080074.html">https://blog.csdn.net/junxuezheng/category_12080074.html</a></p><br><h2 id="STL"><a href="#STL" class="headerlink" title="STL"></a>STL</h2><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/junxuezheng/category_12212735.html">https://blog.csdn.net/junxuezheng/category_12212735.html</a></p><h1 id="Java"><a href="#Java" class="headerlink" title="Java"></a>Java</h1><h2 id="Stream"><a href="#Stream" class="headerlink" title="Stream"></a>Stream</h2><h3 id="去重"><a href="#去重" class="headerlink" title="去重"></a>去重</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 普通去重</span></span><br><span class="line">List&lt;String&gt; distinctElements = list.stream().distinct().collect(Collectors.toList());</span><br><span class="line"></span><br><span class="line"><span class="comment">// 对象去重</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> &lt;T&gt; Predicate&lt;T&gt; <span class="title function_">distinctByKey</span><span class="params">(Function&lt;? <span class="built_in">super</span> T, Object&gt; keyExtractor)</span> &#123;</span><br><span class="line">    Map&lt;Object, Boolean&gt; map = <span class="keyword">new</span> <span class="title class_">ConcurrentHashMap</span>&lt;&gt;();</span><br><span class="line">    <span class="keyword">return</span> t -&gt; map.putIfAbsent(keyExtractor.apply(t), Boolean.TRUE) == <span class="literal">null</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//使用举例</span></span><br><span class="line">persons.stream().filter(distinctByKey(Person::getName))</span><br></pre></td></tr></table></figure><h3 id="分组"><a href="#分组" class="headerlink" title="分组"></a>分组</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Map&lt;String,List&lt;User&gt;&gt; userGroupMap = list.stream().collect(Collectors.groupingBy(User::getType));</span><br></pre></td></tr></table></figure><h2 id="BeanUtils"><a href="#BeanUtils" class="headerlink" title="BeanUtils"></a>BeanUtils</h2><p>Bean 属性拷贝</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 将 src 对象中的属性全部拷贝到 t 中</span></span><br><span class="line"><span class="type">T</span> <span class="variable">t</span> <span class="operator">=</span> BeanUtils.instantiateClass(t.class);</span><br><span class="line">BeanUtils.copyProperties(src, t);</span><br><span class="line"><span class="keyword">return</span> t;</span><br></pre></td></tr></table></figure><h2 id="tomcat"><a href="#tomcat" class="headerlink" title="tomcat"></a>tomcat</h2><p>下载：<code>https://archive.apache.org/dist/tomcat/</code></p><p><code>https://mirrors.cnnic.cn/apache/tomcat/</code></p><h1 id="Windows"><a href="#Windows" class="headerlink" title="Windows"></a>Windows</h1><h2 id="远程连接"><a href="#远程连接" class="headerlink" title="远程连接"></a>远程连接</h2><p>远程连接出现 CredSSP 加密数据库修正的问题时，管理员运行命令行，输入如下命令即可：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">New-Item -Path HKLM:\Software\Microsoft\Windows\CurrentVersion\Policies\System -Name CredSSP -Force</span><br><span class="line">New-Item -Path HKLM:\Software\Microsoft\Windows\CurrentVersion\Policies\System\CredSSP -Name Parameters -Force</span><br><span class="line">Get-Item -Path HKLM:\Software\Microsoft\Windows\CurrentVersion\Policies\System\CredSSP\Parameters | New-ItemProperty -Name AllowEncryptionOracle -Value 2 -PropertyType DWORD -Force</span><br></pre></td></tr></table></figure><br><h2 id="VS-比例打开"><a href="#VS-比例打开" class="headerlink" title="VS 比例打开"></a>VS 比例打开</h2><p>注册表：</p><p>计算机\HKEY_CURRENT_USER\Software\Microsoft\Windows NT\CurrentVersion\AppCompatFlags\Layers</p><p>新建字符串值</p><p>数值名称为 devenv.exe 的绝对路径</p><p>根据你使用的Visual Studio版本，使用不同的值（对应更改2017&#x2F;2019，C&#x2F;D盘等等）</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">C:\Program Files (x86)\Microsoft Visual Studio\2017\Community\Common7\IDE\devenv.exe</span><br><span class="line">C:\Program Files (x86)\Microsoft Visual Studio\2017\Enterprise\Common7\IDE\devenv.exe</span><br><span class="line">C:\Program Files (x86)\Microsoft Visual Studio\2017\Professional\Common7\IDE\devenv.exe</span><br></pre></td></tr></table></figure><p>填写数值数据：<code>DPIUNAWARE</code></p><h1 id="C-1"><a href="#C-1" class="headerlink" title="C#"></a>C#</h1><h2 id="自定义控件属性"><a href="#自定义控件属性" class="headerlink" title="自定义控件属性"></a>自定义控件属性</h2><p>在开发自定义控件件时，有好些 Design 属性是要使用的，如ToolboxItem, ToolboxBitmap, Category, Description等等，不知道这些属性其实也可以将控件搞出来，不过，知道了，会令事件更加简单，令控件更加专业和实用。有时，不知道用法，会令到项目的其他同事好烦，因为这个控件是你提供的。下面对一些常用的Design属性做一个简单的生产介绍。</p><h3 id="ToolboxItem"><a href="#ToolboxItem" class="headerlink" title="ToolboxItem"></a>ToolboxItem</h3><p>有没有试过写一个用户控件后，想它不出现在工具箱中，当然有，有时候是控件的Designer部分没有写好或没写，有时候是控件一拖出来就报错，有时候是内部使用的控件，不想别人一引用DLL就出现控件。其它设置方法可以很简单。</p><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[<span class="meta">ToolboxItem(false)</span>]</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">MyPanel</span> : <span class="title">UserControl</span></span><br><span class="line">&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这样就可以了。“可恶”的用户控件就自动隐藏了，不出现在工具箱中。不过，如果你不知道这样的话，可以会引来一大堆的烦事。</p><h3 id="ToolboxBitmap"><a href="#ToolboxBitmap" class="headerlink" title="ToolboxBitmap"></a>ToolboxBitmap</h3><p>写好一个用户控件后，在工具箱中出来的是一个蓝色的齿轮，这就不是很漂亮了，也不能够直观地表达自己的意图。如果更不幸的你的控件的名称好难认的话，其它的开发者会很麻烦的。怎样才能让用户控件在工具箱中显示不同的图标呢?</p><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[<span class="meta">ToolboxBitmap(typeof(System.Windows.Forms.Panel))</span>]</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">MyPanel</span> : <span class="title">UserControl</span></span><br><span class="line">&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这样就可以了，表示你所做的用户控件使用的图标是Panel的图标。如果不想用系统的图标，要使用自己的图标，可以这样：</p><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[<span class="meta">ToolboxBitmap(typeof(MyPanel), <span class="string">&quot;WindowsApplication1.Images.MyPanel.bmp&quot;</span>)</span>]</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">MyPanel</span> : <span class="title">UserControl</span></span><br><span class="line">&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Category-与-Description"><a href="#Category-与-Description" class="headerlink" title="Category 与 Description"></a>Category 与 Description</h3><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[<span class="meta">Category(<span class="string">&quot;Appearance&quot;</span>), Description(<span class="string">&quot;阴影色&quot;</span>)</span>]</span><br><span class="line"><span class="keyword">public</span> System.Drawing.Color ShadowColor &#123; <span class="keyword">get</span> &#123; …&#125; <span class="keyword">set</span> &#123; …&#125; &#125;</span><br></pre></td></tr></table></figure><p>这两个是经常都会写在一起的属性，Category表示类型，如属性框中所显示的外观，布局等，当然，你可以自己写一个，叫“自定义属性”，而Description就是这个属性的描述，用来说明属性有什么用途。这两个的设置相对都比较简单，可以说，一看就知道，不过提一下，Appearance是特殊的词，在属性面板中，它就是外观一栏。</p><h3 id="DefaultValue"><a href="#DefaultValue" class="headerlink" title="DefaultValue"></a>DefaultValue</h3><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[<span class="meta">DefaultValue(typeof(Color), <span class="string">&quot;DarkGray&quot;</span>)</span>]</span><br><span class="line"><span class="keyword">public</span> System.Drawing.Color ShadowColor &#123; <span class="keyword">get</span> &#123; …&#125; <span class="keyword">set</span> &#123; …&#125; &#125;</span><br></pre></td></tr></table></figure><p>用于设置默认的值，对于string,bool,int，可以直接写出来，如<code>[DefaultValue(10)]</code>，这是可以的，不过，不是这三种类型的话，就比较麻烦，一定要先转化为string才能设置成功。如上面的DarkGray，这是系统定义的颜色，这还是比较好处理的。不过，如果是一些自定义的颜色，如颜色是128,0,128，你应该将128转为16进制，写成0x800080，前缀0x是一定要加的。最后就这样 <code>[DefaultValue(typeof(Color), &quot;0x800080&quot;)]</code></p><h3 id="Browsable"><a href="#Browsable" class="headerlink" title="Browsable"></a>Browsable</h3><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">partial</span> <span class="keyword">class</span> <span class="title">MyTextBox</span> : <span class="title">TextBox</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">MyTextBox</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">var</span> s = DefaultText;</span><br><span class="line">        InitializeComponent();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    [<span class="meta">Browsable(true)</span>]</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> DefaultText &#123;<span class="keyword">get</span>;<span class="keyword">set</span>;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>表示，将在属性面板中显示这个属性。</p><p>如果设置为false，将不会显示（但是仍然会在对应的*.Designer.cs中进行序列化）</p><h3 id="DesignerSerializationVisibility"><a href="#DesignerSerializationVisibility" class="headerlink" title="DesignerSerializationVisibility"></a>DesignerSerializationVisibility</h3><p>表示，是否在*.Designer.cs文件中将设置的代码写出来，也就是是否要实现序列化。默认为<br><code>[DesignerSerializationVisibility(DesignerSerializationVisibility.Visible)]</code>表示需要实现序列化。</p><p>如果设置为hidden：</p><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[<span class="meta">DesignerSerializationVisibility(DesignerSerializationVisibility.Hidden)</span>]</span><br><span class="line"><span class="keyword">public</span> List&lt;Person&gt; Persons &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br></pre></td></tr></table></figure><p>将不会被序列化</p><p>如果自定义控件中有些属性不需要显示在属性面板或者不需要序列化时，建议 hidden 掉。</p><h2 id="Region"><a href="#Region" class="headerlink" title="Region"></a>Region</h2><p>自定义控件时，使用 Region 来添加不透明区域，其他区域则是透明的</p><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">override</span> <span class="keyword">void</span> <span class="title">OnPaint</span>(<span class="params">PaintEventArgs e</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">base</span>.OnPaint(e);</span><br><span class="line">    Region rgn = <span class="keyword">new</span> Region();</span><br><span class="line">    GraphicsPath path = <span class="keyword">new</span> GraphicsPath();</span><br><span class="line">    rgn.MakeEmpty();</span><br><span class="line">    path.AddEllipse(<span class="number">0</span>, <span class="number">0</span>, Width, Height);</span><br><span class="line">    rgn.Union(path);</span><br><span class="line">    Region = rgn;</span><br><span class="line">    path.Reset();</span><br><span class="line"></span><br><span class="line">    Graphics g = e.Graphics;</span><br><span class="line">    g.FillEllipse(Brushes.Black, <span class="number">0</span>, <span class="number">0</span>, Width, Height);</span><br><span class="line">    g.FillEllipse(<span class="keyword">new</span> SolidBrush(BackColor), <span class="number">1</span>, <span class="number">1</span>, Width - <span class="number">2</span>, Height - <span class="number">2</span>);</span><br><span class="line"></span><br><span class="line">    path.Dispose();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>注意：在画带边框圆形时，黑边框填充区域与 Region 保持一致，背景色填充区域需往内部收缩一个像素<br>在画带边框矩形时无需填充黑边框，画的黑边框区域起始坐标相同，长与宽收缩一个像素即可</p></blockquote><h2 id="发送按键"><a href="#发送按键" class="headerlink" title="发送按键"></a>发送按键</h2><p><a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/dotnet/api/system.windows.forms.sendkeys?view=netframework-4.6.1">https://learn.microsoft.com/en-us/dotnet/api/system.windows.forms.sendkeys?view=netframework-4.6.1</a></p><p>如：发送 <code>alt + tab</code></p><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SendKeys.Send(<span class="string">&quot;%+&#123;TAB&#125;&quot;</span>);</span><br></pre></td></tr></table></figure><h2 id="winform-窗口不显示在任务栏"><a href="#winform-窗口不显示在任务栏" class="headerlink" title="winform 窗口不显示在任务栏"></a>winform 窗口不显示在任务栏</h2><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">this</span>.ShowInTaskbar = <span class="literal">false</span>;</span><br></pre></td></tr></table></figure><h2 id="winform-窗口-alt-tab-不显示"><a href="#winform-窗口-alt-tab-不显示" class="headerlink" title="winform 窗口 alt + tab 不显示"></a>winform 窗口 alt + tab 不显示</h2><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> 让程序不显示在alt+Tab视图窗体中</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="keyword">protected</span> <span class="keyword">override</span> CreateParams CreateParams</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">get</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">const</span> <span class="built_in">int</span> WS_EX_APPWINDOW = <span class="number">0x40000</span>;</span><br><span class="line">        <span class="keyword">const</span> <span class="built_in">int</span> WS_EX_TOOLWINDOW = <span class="number">0x80</span>;</span><br><span class="line">        CreateParams cp = <span class="keyword">base</span>.CreateParams;</span><br><span class="line">        cp.ExStyle &amp;= (~WS_EX_APPWINDOW);</span><br><span class="line">        cp.ExStyle |= WS_EX_TOOLWINDOW;</span><br><span class="line">        <span class="keyword">return</span> cp;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="hex转double"><a href="#hex转double" class="headerlink" title="hex转double"></a>hex转double</h2><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="built_in">double</span> <span class="title">hex2double</span>(<span class="params"><span class="built_in">string</span> hex</span>)</span> &#123;</span><br><span class="line">    <span class="built_in">byte</span>[] t = <span class="keyword">new</span> <span class="built_in">byte</span>[<span class="number">8</span>];</span><br><span class="line">    <span class="keyword">for</span> (<span class="built_in">int</span> i; i &lt; hex.Length/<span class="number">2</span>; i++) &#123;</span><br><span class="line">        <span class="comment">// 小端hex</span></span><br><span class="line">        b[<span class="number">8</span>-i<span class="number">-1</span>] = Convert.ToByte(hex.Substring(i*<span class="number">2</span>,<span class="number">2</span>), <span class="number">16</span>);</span><br><span class="line">        <span class="comment">// 大端hex</span></span><br><span class="line">        <span class="comment">//b[i] = Convert.ToByte(hex.Substring(i*2,2), 16);</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> BitConverter.ToDouble(t, <span class="number">0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="Base64-编码与解码"><a href="#Base64-编码与解码" class="headerlink" title="Base64 编码与解码"></a>Base64 编码与解码</h2><p>编码：<br>byte[] bytes&#x3D;Encoding.Default.GetBytes(“要转换的字符串”);<br>Convert.ToBase64String(bytes);<br>解码：<br>&#x2F;&#x2F;“ztKwrsTj”是“我爱你”的base64编码<br>byte[] outputb &#x3D; Convert.FromBase64String(“ztKwrsTj”);<br>string orgStr&#x3D; Encoding.Default.GetString(outputb);</p><h2 id="Chart"><a href="#Chart" class="headerlink" title="Chart"></a>Chart</h2><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line">chart1.Series.Clear();</span><br><span class="line"></span><br><span class="line">Series Speed = <span class="keyword">new</span> Series(<span class="string">&quot;速度&quot;</span>);</span><br><span class="line"></span><br><span class="line">Speed.ChartType = SeriesChartType.Spline;</span><br><span class="line">Speed.IsValueShownAsLabel = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 标题</span></span><br><span class="line"><span class="comment">// chart1.Titles.Add(&quot;主标题&quot;);</span></span><br><span class="line"><span class="comment">// chart1.Titles[0].ForeColor = Color.Blue;</span></span><br><span class="line"><span class="comment">// chart1.Titles[0].Font = new Font(&quot;宋体&quot;, 12f, FontStyle.Regular);</span></span><br><span class="line"><span class="comment">// chart1.Titles[0].Alignment = ContentAlignment.TopCenter;</span></span><br><span class="line"><span class="comment">// chart1.Titles.Add(&quot;右标题&quot;);</span></span><br><span class="line"><span class="comment">// chart1.Titles[1].ForeColor = Color.Blue;</span></span><br><span class="line"><span class="comment">// chart1.Titles[1].Font = new Font(&quot;宋体&quot;, 8f, FontStyle.Regular);</span></span><br><span class="line"><span class="comment">// chart1.Titles[1].Alignment = ContentAlignment.TopRight;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 控件背景</span></span><br><span class="line">chart1.BackColor = Color.Transparent;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 图表区背景</span></span><br><span class="line">chart1.ChartAreas[<span class="number">0</span>].BackColor = Color.LightGray;</span><br><span class="line">chart1.ChartAreas[<span class="number">0</span>].BorderColor = Color.LightGray;</span><br><span class="line"></span><br><span class="line"><span class="comment">// X轴网络线条</span></span><br><span class="line">chart1.ChartAreas[<span class="number">0</span>].AxisX.MajorGrid.Enabled = <span class="literal">true</span>;</span><br><span class="line">chart1.ChartAreas[<span class="number">0</span>].AxisX.MajorGrid.Interval = <span class="number">100</span>; <span class="comment">//网格间隔</span></span><br><span class="line">chart1.ChartAreas[<span class="number">0</span>].AxisX.MajorGrid.LineColor = Color.White; <span class="comment">// 网格颜色</span></span><br><span class="line">chart1.ChartAreas[<span class="number">0</span>].AxisX.MajorGrid.LineDashStyle = ChartDashStyle.Dash; <span class="comment">//设置网格类型为虚线</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// X轴标签间距</span></span><br><span class="line"><span class="comment">// chart1.ChartAreas[0].AxisX.Interval = 500;</span></span><br><span class="line"><span class="comment">// chart1.ChartAreas[0].AxisX.LabelStyle.IsStaggered = true;</span></span><br><span class="line"><span class="comment">// chart1.ChartAreas[0].AxisX.LabelStyle.Angle = -30;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// X坐标轴颜色</span></span><br><span class="line"><span class="comment">//chart1.ChartAreas[0].AxisX.LineColor = ColorTranslator.FromHtml(&quot;#808080&quot;);</span></span><br><span class="line">chart1.ChartAreas[<span class="number">0</span>].AxisX.LabelStyle.ForeColor = Color.Black;</span><br><span class="line">chart1.ChartAreas[<span class="number">0</span>].AxisX.LabelStyle.Font = <span class="keyword">new</span> Font(<span class="string">&quot;微软雅黑&quot;</span>, <span class="number">10f</span>, FontStyle.Regular);</span><br><span class="line">chart1.ChartAreas[<span class="number">0</span>].AxisX.IsLabelAutoFit = <span class="literal">false</span>;</span><br><span class="line">chart1.ChartAreas[<span class="number">0</span>].AxisX.Maximum = <span class="number">3000</span>;</span><br><span class="line">chart1.ChartAreas[<span class="number">0</span>].AxisX.Minimum = <span class="number">-3000</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// X坐标轴标题</span></span><br><span class="line">chart1.ChartAreas[<span class="number">0</span>].AxisX.Title = <span class="string">&quot;[mm]&quot;</span>;</span><br><span class="line">chart1.ChartAreas[<span class="number">0</span>].AxisX.TitleFont = <span class="keyword">new</span> Font(<span class="string">&quot;微软雅黑&quot;</span>, <span class="number">10f</span>, FontStyle.Regular);</span><br><span class="line">chart1.ChartAreas[<span class="number">0</span>].AxisX.TitleForeColor = Color.Black;</span><br><span class="line">chart1.ChartAreas[<span class="number">0</span>].AxisX.TextOrientation = TextOrientation.Horizontal;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// Y坐标轴颜色</span></span><br><span class="line"><span class="comment">//chart1.ChartAreas[0].AxisY.LineColor = ColorTranslator.FromHtml(&quot;#808080&quot;);</span></span><br><span class="line">chart1.ChartAreas[<span class="number">0</span>].AxisY.LabelStyle.ForeColor = Color.Black;</span><br><span class="line">chart1.ChartAreas[<span class="number">0</span>].AxisY.LabelStyle.Font = <span class="keyword">new</span> Font(<span class="string">&quot;微软雅黑&quot;</span>, <span class="number">10f</span>, FontStyle.Regular);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Y坐标轴标题</span></span><br><span class="line">chart1.ChartAreas[<span class="number">0</span>].AxisY.Title = <span class="string">&quot;[um]&quot;</span>;</span><br><span class="line">chart1.ChartAreas[<span class="number">0</span>].AxisY.ToolTip = <span class="string">&quot;[um]&quot;</span>;</span><br><span class="line">chart1.ChartAreas[<span class="number">0</span>].AxisY.TitleFont = <span class="keyword">new</span> Font(<span class="string">&quot;微软雅黑&quot;</span>, <span class="number">10f</span>, FontStyle.Regular);</span><br><span class="line">chart1.ChartAreas[<span class="number">0</span>].AxisY.TitleForeColor = Color.Black;</span><br><span class="line">chart1.ChartAreas[<span class="number">0</span>].AxisY.TextOrientation = TextOrientation.Rotated270;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Y轴网格线条</span></span><br><span class="line">chart1.ChartAreas[<span class="number">0</span>].AxisY.MajorGrid.Enabled = <span class="literal">true</span>;</span><br><span class="line">chart1.ChartAreas[<span class="number">0</span>].AxisY.MajorGrid.LineColor = Color.White;</span><br><span class="line">chart1.ChartAreas[<span class="number">0</span>].AxisY.MinorGrid.Interval = <span class="number">50</span>;</span><br><span class="line">chart1.ChartAreas[<span class="number">0</span>].AxisY.MajorGrid.LineDashStyle = ChartDashStyle.Dash; <span class="comment">//网格Y轴线类型</span></span><br><span class="line"><span class="comment">//chart1.ChartAreas[0].AxisY.MajorGrid.LineColor = ColorTranslator.FromHtml(&quot;#E6E6FA&quot;);</span></span><br><span class="line"><span class="comment">//chart1.ChartAreas[0].AxisY2.LineColor = Color.Transparent;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 背景渐变</span></span><br><span class="line"><span class="comment">//chart1.ChartAreas[0].BackGradientStyle = GradientStyle.None;</span></span><br><span class="line"></span><br><span class="line">Speed.Points.DataBindXY(x, y);</span><br><span class="line"></span><br><span class="line"><span class="comment">//把 series 添加到 chart 上</span></span><br><span class="line">chart1.Series.Add(Speed);</span><br></pre></td></tr></table></figure><h1 id="ELK"><a href="#ELK" class="headerlink" title="ELK"></a>ELK</h1><h2 id="定时清理索引-1"><a href="#定时清理索引-1" class="headerlink" title="定时清理索引 1"></a>定时清理索引 1</h2><p>背景：由于 ES 的日志索引每天都在增长，很快缓存就吃不消了， 需要定期清理一下过期不用的索引， 在此使用定期删除索引的方法</p><p>脚本 delete_es_indices_over_15_day.sh</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#删除早于15天的ES集群的索引</span></span><br><span class="line"><span class="keyword">function</span> <span class="function"><span class="title">delete_indices</span></span>() &#123;</span><br><span class="line">  param=$(<span class="built_in">echo</span> <span class="variable">$1</span>)</span><br><span class="line">  <span class="comment">#截取索引的日期部分（用于下面的日期比较是否小于15日），我的索引是com-字符串后面的部分为日期， 比如: www.test.com-2020.08.08</span></span><br><span class="line">  dateValue=$(<span class="built_in">echo</span> <span class="variable">$&#123;param#*com-&#125;</span>)</span><br><span class="line">  <span class="comment">#截取日期的前部分作为索引的名称（后续需要替换-为.， 然后和日期拼接起来成为一个真正的索引名称，用于删除）</span></span><br><span class="line">  name=$(<span class="built_in">echo</span> <span class="variable">$&#123;param%-$dateValue*&#125;</span>)</span><br><span class="line"></span><br><span class="line">  <span class="built_in">echo</span> <span class="string">&quot;name=<span class="variable">$name</span> date=<span class="variable">$dateValue</span>&quot;</span> </span><br><span class="line">  comp_date=`<span class="built_in">date</span> -d <span class="string">&quot;15 day ago&quot;</span> +<span class="string">&quot;%Y-%m-%d&quot;</span>`</span><br><span class="line">  date1=<span class="string">&quot;<span class="variable">$dateValue</span> 00:00:00&quot;</span></span><br><span class="line">  date2=<span class="string">&quot;<span class="variable">$comp_date</span> 00:00:00&quot;</span></span><br><span class="line"></span><br><span class="line">  t1=`<span class="built_in">date</span> -d <span class="string">&quot;<span class="variable">$date1</span>&quot;</span> +%s` </span><br><span class="line">  t2=`<span class="built_in">date</span> -d <span class="string">&quot;<span class="variable">$date2</span>&quot;</span> +%s`</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> [ <span class="variable">$t1</span> -le <span class="variable">$t2</span> ]; <span class="keyword">then</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$1</span>时间早于<span class="variable">$comp_date</span>，进行索引删除&quot;</span></span><br><span class="line">    <span class="comment">#转换一下格式，将类似www-test-com格式转化为www.test.com</span></span><br><span class="line">    format_name=`<span class="built_in">echo</span> <span class="variable">$name</span>| sed <span class="string">&#x27;s/-/\./g&#x27;</span>`</span><br><span class="line"></span><br><span class="line">    <span class="comment">#转换一下格式，将类似2020-10-01格式转化为2020.10.01</span></span><br><span class="line">    format_date=`<span class="built_in">echo</span> <span class="variable">$dateValue</span>| sed <span class="string">&#x27;s/-/\./g&#x27;</span>`</span><br><span class="line">    <span class="comment">#拼接成索引名称</span></span><br><span class="line">    indexName=<span class="string">&quot;<span class="variable">$format_name</span>-<span class="variable">$format_date</span>&quot;</span></span><br><span class="line">    <span class="comment">#删除索引</span></span><br><span class="line">    curl -XDELETE http://localhost:9200/<span class="variable">$indexName</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$indexName</span>删除成功&quot;</span></span><br><span class="line">  <span class="keyword">fi</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">#注意， 由于我的日志都是包含有&quot;com-&quot;的字符串，故使用该字符串模糊查询索引列表</span></span><br><span class="line">curl -XGET http://localhost:9200/_cat/indices | awk -F<span class="string">&quot; &quot;</span> <span class="string">&#x27;&#123;print $3&#125;&#x27;</span>|grep com- | <span class="built_in">uniq</span> | sed <span class="string">&#x27;s/\./-/g&#x27;</span> | <span class="keyword">while</span> <span class="built_in">read</span> LINE</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line"><span class="comment">#调用索引删除函数， 结果打印到日志</span></span><br><span class="line">delete_indices <span class="variable">$LINE</span> &gt;&gt; /home/logs/delete_indices.log</span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure><p>crontab 定时配置,每天1点定时删除</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">0 1 * * * sh /home/delete_es_indices_over_15_day.sh</span><br></pre></td></tr></table></figure><h2 id="定时清理索引-2"><a href="#定时清理索引-2" class="headerlink" title="定时清理索引 2"></a>定时清理索引 2</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line"><span class="comment">###################################</span></span><br><span class="line"><span class="comment">#删除早于十天的ES集群的索引</span></span><br><span class="line"><span class="comment">###################################</span></span><br><span class="line"><span class="keyword">function</span> <span class="function"><span class="title">delete_indices</span></span>() &#123;</span><br><span class="line">    comp_date=`<span class="built_in">date</span> -d <span class="string">&quot;10 day ago&quot;</span> +<span class="string">&quot;%Y-%m-%d&quot;</span>`</span><br><span class="line">    date1=<span class="string">&quot;<span class="variable">$1</span> 00:00:00&quot;</span></span><br><span class="line">    date2=<span class="string">&quot;<span class="variable">$comp_date</span> 00:00:00&quot;</span></span><br><span class="line"></span><br><span class="line">    t1=`<span class="built_in">date</span> -d <span class="string">&quot;<span class="variable">$date1</span>&quot;</span> +%s` </span><br><span class="line">    t2=`<span class="built_in">date</span> -d <span class="string">&quot;<span class="variable">$date2</span>&quot;</span> +%s` </span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> [ <span class="variable">$t1</span> -le <span class="variable">$t2</span> ]; <span class="keyword">then</span></span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$1</span>时间早于<span class="variable">$comp_date</span>，进行索引删除&quot;</span></span><br><span class="line">        <span class="comment">#转换一下格式，将类似2017-10-01格式转化为2017.10.01</span></span><br><span class="line">        format_date=`<span class="built_in">echo</span> <span class="variable">$1</span>| sed <span class="string">&#x27;s/-/\./g&#x27;</span>`</span><br><span class="line">        curl -XDELETE http://127.0.0.1:9200/*<span class="variable">$format_date</span></span><br><span class="line">    <span class="keyword">fi</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">curl -XGET http://127.0.0.1:9200/_cat/indices | awk -F<span class="string">&quot; &quot;</span> <span class="string">&#x27;&#123;print $3&#125;&#x27;</span> | awk -F<span class="string">&quot;-&quot;</span> <span class="string">&#x27;&#123;print $NF&#125;&#x27;</span> | egrep <span class="string">&quot;[0-9]*\.[0-9]*\.[0-9]*&quot;</span> | <span class="built_in">sort</span> | <span class="built_in">uniq</span>  | sed <span class="string">&#x27;s/\./-/g&#x27;</span> | <span class="keyword">while</span> <span class="built_in">read</span> LINE</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">    <span class="comment">#调用索引删除函数</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;delete indexes...&quot;</span></span><br><span class="line">    delete_indices <span class="variable">$LINE</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;deleted success&quot;</span></span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure><br><h1 id="docker"><a href="#docker" class="headerlink" title="docker"></a>docker</h1><h2 id="加速器"><a href="#加速器" class="headerlink" title="加速器"></a>加速器</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">sudo <span class="built_in">tee</span> /etc/docker/daemon.json &lt;&lt;-<span class="string">&#x27;EOF&#x27;</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">&quot;registry-mirrors&quot;</span>: [<span class="string">&quot;https://edxcm6bo.mirror.aliyuncs.com&quot;</span>]</span><br><span class="line">&#125;</span><br><span class="line">EOF</span><br><span class="line">sudo systemctl daemon-reload</span><br><span class="line">sudo systemctl restart docker</span><br></pre></td></tr></table></figure><h2 id="日志"><a href="#日志" class="headerlink" title="日志"></a>日志</h2><p>docker-compose 的每个容器下中加入如下内容：</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">logging:</span> </span><br><span class="line">  <span class="attr">driver:</span> <span class="string">&quot;json-file&quot;</span></span><br><span class="line">  <span class="attr">options:</span> </span><br><span class="line">    <span class="attr">max-size:</span> <span class="string">&quot;20m&quot;</span></span><br><span class="line">    <span class="attr">max-file:</span> <span class="string">&quot;1&quot;</span></span><br></pre></td></tr></table></figure><p>或者在 &#x2F;etc&#x2F;docker&#x2F;daemon.json 加入：</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;registry-mirrors&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;http://f613ce8f.m.daocloud.io&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;log-driver&quot;</span><span class="punctuation">:</span><span class="string">&quot;json-file&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;log-opts&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span><span class="attr">&quot;max-size&quot;</span><span class="punctuation">:</span><span class="string">&quot;20m&quot;</span><span class="punctuation">,</span> <span class="attr">&quot;max-file&quot;</span><span class="punctuation">:</span><span class="string">&quot;2&quot;</span><span class="punctuation">&#125;</span>  </span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><h2 id="解决警告"><a href="#解决警告" class="headerlink" title="解决警告"></a>解决警告</h2><h3 id="WARNING-No-swap-limit-support"><a href="#WARNING-No-swap-limit-support" class="headerlink" title="WARNING: No swap limit support"></a>WARNING: No swap limit support</h3><p>编辑&#x2F;etc&#x2F;default&#x2F;grub文件。<br>vim &#x2F;etc&#x2F;default&#x2F;grub</p><p>找到GRUB_CMDLINE_LINUX&#x3D;配置项，并追加“cgroup_enable&#x3D;memory swapaccount&#x3D;1”。</p><p><strong>注意</strong>：如果GRUB_CMDLINE_LINUX&#x3D;内有内容，切记不可删除，只需在后面追加cgroup_enable&#x3D;memory swapaccount&#x3D;1并用空格和前面的内容分隔开。</p><h3 id="启动依赖"><a href="#启动依赖" class="headerlink" title="启动依赖"></a>启动依赖</h3><p>dokcer depends_on 用于在 doker compose 中定义容器的依赖关系，及先启动哪个容器，在这个容器启动之后才能启动另外一个容器。</p><p>但这会存在一个问题，当一个容器开始运行，但是它其实并没有完全启动的时候，依赖它的容器尽管定义了依赖关系，仍然会启动失败（依赖的容器只是开始运行，并没有进入到可以提供服务的阶段）。</p><p>我们可以使用 docker 的 HEALTHCHECK 解决这个问题。docker 的 HEALTHCHECK 可以给容器增加两个状态：healthy 和 unhealthy。在 Dockerfile 中使用 HEALTHCHECK 来构建一个容器，具体的语法如下：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">HEALTHCHECK --interval=xx --timeout=xx --retries=xx CMD &lt;cmd to check if the container is healthy&gt;</span><br></pre></td></tr></table></figure><p>返回的结果表示一个容器是否健康：0：健康，1：不健康（还有一个 2 值，处于保留中）。</p><p>举个例子：</p><p>容器 platform-configuration 的 Dockerfile:</p><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">FROM</span> openjdk:<span class="number">12</span>-alpine</span><br><span class="line"></span><br><span class="line"><span class="keyword">MAINTAINER</span> icyfenix</span><br><span class="line"></span><br><span class="line"><span class="keyword">ENV</span> SPRING_OUTPUT_ANSI_ENABLED=ALWAYS \</span><br><span class="line">    JAVA_OPTS=<span class="string">&quot;&quot;</span> \</span><br><span class="line">    PORT=<span class="number">8888</span> \</span><br><span class="line">    PROFILES=<span class="string">&quot;native&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">ADD</span><span class="language-bash"> /target/*.jar /config.jar</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> apk update &amp;&amp; apk add curl &amp;&amp; <span class="built_in">rm</span> -rf /var/cache/apk/*</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">HEALTHCHECK</span><span class="language-bash"> --interval=5s --<span class="built_in">timeout</span>=30s CMD curl -f http://localhost:<span class="variable">$PORT</span>/actuator/health || <span class="built_in">exit</span> 1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">ENTRYPOINT</span><span class="language-bash"> [<span class="string">&quot;sh&quot;</span>, <span class="string">&quot;-c&quot;</span>, <span class="string">&quot;java <span class="variable">$JAVA_OPTS</span> -jar /config.jar --spring.profiles.active=<span class="variable">$PROFILES</span>&quot;</span>]</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">EXPOSE</span> $PORT</span><br></pre></td></tr></table></figure><p>docker-compose.yaml 的一部分</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">platform-gateway:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">icyfenix/bookstore-springcloud:platform-gateway</span></span><br><span class="line">    <span class="attr">depends_on:</span></span><br><span class="line">      <span class="attr">platform-configuration:</span></span><br><span class="line">        <span class="attr">condition:</span> <span class="string">service_healthy</span></span><br><span class="line">      <span class="attr">platform-registry:</span></span><br><span class="line">        <span class="attr">condition:</span> <span class="string">service_healthy</span></span><br><span class="line">    <span class="attr">environment:</span></span><br><span class="line">      <span class="attr">CONFIG_HOST:</span> <span class="string">platform-configuration</span></span><br><span class="line">      <span class="attr">REGISTRY_HOST:</span> <span class="string">platform-registry</span></span><br><span class="line">    <span class="attr">restart:</span> <span class="string">always</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="number">8080</span><span class="string">:8080</span></span><br></pre></td></tr></table></figure><h1 id="linux-1"><a href="#linux-1" class="headerlink" title="linux"></a>linux</h1><h2 id="rhel"><a href="#rhel" class="headerlink" title="rhel"></a>rhel</h2><p>原因：redhat自带的插件subscription-manager。这个插件的作用就是Red Hat Subscription Manager订阅管理器，就是它让你一直register</p><p>解决办法：将配置文件subscription-manager.conf中的enable注释掉</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost yum.repos.d]# vi /etc/yum/pluginconf.d/subscription-manager.conf</span><br><span class="line"></span><br><span class="line">[main]</span><br><span class="line">#enabled=1</span><br></pre></td></tr></table></figure><h2 id="command"><a href="#command" class="headerlink" title="command"></a>command</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">command: command [-pVv] command [arg ...]</span><br><span class="line">    Execute a simple command or display information about commands.</span><br><span class="line"></span><br><span class="line">    Runs COMMAND with ARGS suppressing  shell function lookup, or display</span><br><span class="line">    information about the specified COMMANDs.  Can be used to invoke commands</span><br><span class="line">    on disk when a function with the same name exists.</span><br><span class="line"></span><br><span class="line">    Options:</span><br><span class="line">      -p    use a default value for PATH that is guaranteed to find all of</span><br><span class="line">            the standard utilities</span><br><span class="line">      -v    print a description of COMMAND similar to the `type&#x27; builtin</span><br><span class="line">      -V    print a more verbose description of each COMMAND</span><br><span class="line"></span><br><span class="line">    Exit Status:</span><br><span class="line">    Returns exit status of COMMAND, or failure if COMMAND is not found.</span><br></pre></td></tr></table></figure><h2 id="后台运行"><a href="#后台运行" class="headerlink" title="后台运行"></a>后台运行</h2><p><code>java -jar app.jar &amp;&gt; /dev/null &amp;</code></p><h2 id="screen"><a href="#screen" class="headerlink" title="screen"></a>screen</h2><p>执行 <code>screen</code> 命令会创建一个 screen 终端</p><ul><li><code>screen -S NAME</code> 创建一个终端</li><li><code>screen -ls</code> 显示已创建的终端</li><li><code>screen -r NAME</code> 回到终端</li><li><code>screen -d NAME</code> 远程 detach 某个终端</li></ul><p>在终端中按下 <code>Ctrl a d</code> 即可离开终端</p><h2 id="shell-嵌入-python"><a href="#shell-嵌入-python" class="headerlink" title="shell 嵌入 python"></a>shell 嵌入 python</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">python3 - <span class="string">&quot;<span class="variable">$@</span>&quot;</span> &lt;&lt;<span class="string">END</span></span><br><span class="line"><span class="string">#!/usr/bin/python3</span></span><br><span class="line"><span class="string">import sys</span></span><br><span class="line"><span class="string">if __name__ == &quot;__main__&quot;:</span></span><br><span class="line"><span class="string">    print(len(sys.argv[1].split(&quot;,&quot;)))</span></span><br><span class="line"><span class="string">END</span></span><br></pre></td></tr></table></figure><h2 id="find-命令"><a href="#find-命令" class="headerlink" title="find 命令"></a>find 命令</h2><p>查找当前目录下的以 .log 结尾的文件或目录，并移动到 test 目录下（<strong>注意应先有 test 目录</strong>）</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">find -name <span class="string">&quot;*.log&quot;</span> -<span class="built_in">exec</span> <span class="built_in">mv</span> &#123;&#125; <span class="built_in">test</span> \;</span><br></pre></td></tr></table></figure><p>递归修改目录权限：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">find -type d -exec chmod 755 &#123;&#125; \;</span><br></pre></td></tr></table></figure><p>递归修改文件权限：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">find -type f -exec chmod 644 &#123;&#125; \;</span><br></pre></td></tr></table></figure><h2 id="目录相关命令"><a href="#目录相关命令" class="headerlink" title="目录相关命令"></a>目录相关命令</h2><ul><li><code>dirname</code>：显示某个文件或目录的上级所有目录</li><li><code>basename</code>：显示某个文件或目录的名称</li></ul><h2 id="时间修改"><a href="#时间修改" class="headerlink" title="时间修改"></a>时间修改</h2><p>修改系统时间：<code>date -s &quot;2023-01-01 00:00:00&quot;</code></p><p>查看硬件时间：<code>hwclock --show</code></p><p>修改硬件时间：<code>hwclock --set --date &quot;2023-01-01 00:00:00&quot;</code></p><p>让系统时间和硬件时间保持一致：<code>hwclock --hctosys</code></p><p>将系统时间写入硬件时间：<code>hwclock -w</code></p><p>设置时区：<code>timedatectl set-timezone Asia/Shanghai</code></p><p>同步时间：<code>ntpdate npt1.aliyun.com</code></p><p>定时同步：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">crontab -e</span><br><span class="line">0 12 * * * ntpdate cn.pool.ntp.org</span><br></pre></td></tr></table></figure><h3 id="ntp-搭建"><a href="#ntp-搭建" class="headerlink" title="ntp 搭建"></a>ntp 搭建</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">yum install ntp ntpdate -y </span><br><span class="line">systemctl restart ntpd</span><br><span class="line">systemctl enable ntpd</span><br><span class="line">echo &quot;SYNC_HWCLOCK=yes&quot; &gt;&gt; /etc/sysconfig/ntpd</span><br></pre></td></tr></table></figure><p>配置文件 &#x2F;etc&#x2F;ntp.conf 如下：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">#会把时间误差记录下来写入driftfile，这样即使重新开机以后之前的计算结果也就不会丢失了</span><br><span class="line">driftfile /var/lib/ntp/drift</span><br><span class="line">#新增日志目录</span><br><span class="line">logfile /var/log/ntpd.log</span><br><span class="line">restrict default nomodify notrap nopeer noquery</span><br><span class="line">restrict 127.0.0.1</span><br><span class="line">restrict ::1</span><br><span class="line">#控制允许哪些网络查询和同步时间，这里允许192.168.10.0网段上的所有机器可以从这台机器上查询和同步时间</span><br><span class="line">restrict 192.168.10.0 mask 255.255.255.0 nomodify notrap</span><br><span class="line">server 0.cn.pool.ntp.org iburst</span><br><span class="line">server 1.cn.pool.ntp.org iburst</span><br><span class="line">server 2.cn.pool.ntp.org iburst</span><br><span class="line">server 3.cn.pool.ntp.org iburst</span><br><span class="line"># 新增当外部时间不可用时可以使用本地时间</span><br><span class="line">server 192.168.10.30 iburst          </span><br><span class="line"># startum 为时间服务器的层次；设为0则为顶级，如果要向别的NTP服务器更新时间，请不要把它设为0，默认为10</span><br><span class="line">fudge 127.0.0.1 stratum 10         </span><br><span class="line">includefile /etc/ntp/crypto/pw</span><br><span class="line">keys /etc/ntp/keys</span><br><span class="line">disable monitor</span><br></pre></td></tr></table></figure><p>内网ntp服务端主要配置：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">restrict default nomodify notrap nopeer noquery</span><br><span class="line">restrict 127.0.0.1</span><br><span class="line">restrict ::1</span><br><span class="line">restrict 192.168.0.0 mask 255.255.255.0 nomodify notrap</span><br><span class="line"># 让服务端同步本地时间</span><br><span class="line">server 127.127.1.0</span><br><span class="line">fudge 127.127.1.0 stratum 8</span><br></pre></td></tr></table></figure><p>客户端：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">server 192.160.0.10</span><br></pre></td></tr></table></figure><p>windows 同步：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">timedate.cpl</span><br></pre></td></tr></table></figure><h2 id="安装-Docker-CE"><a href="#安装-Docker-CE" class="headerlink" title="安装 Docker CE"></a>安装 Docker CE</h2><p>官网：<a target="_blank" rel="noopener" href="https://docs.docker.com/install/linux/docker-ce/ubuntu/">https://docs.docker.com/install/linux/docker-ce/ubuntu/</a></p><p>授于当前用户以 root 权限运行Docker CLI<br><code>sudo usermod -aG docker $USER</code></p><h2 id="挂载相关"><a href="#挂载相关" class="headerlink" title="挂载相关"></a>挂载相关</h2><p>单次挂载：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mount -o loop /data/ISO/CentOS-8.5.2111-x86_64-dvd1.iso /mnt/cdrom</span><br></pre></td></tr></table></figure><p>开机自动挂载：<br>fstab</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/data/ISO/CentOS-8.5.2111-x86_64-dvd1.iso /mnt/cdrom iso9660 defaults,ro,loop 0</span><br></pre></td></tr></table></figure><h1 id="Python"><a href="#Python" class="headerlink" title="Python"></a>Python</h1><h2 id="Pip"><a href="#Pip" class="headerlink" title="Pip"></a>Pip</h2><p>如果出现 pip 无法使用的情况，执行如下命令重装 pip：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python -m pip install -U pip</span><br></pre></td></tr></table></figure><h2 id="oracle"><a href="#oracle" class="headerlink" title="oracle"></a>oracle</h2><p>pip install cx_Oracle</p><p><a target="_blank" rel="noopener" href="https://www.oracle.com/database/technologies/instant-client/downloads.html">https://www.oracle.com/database/technologies/instant-client/downloads.html</a></p><h1 id="temp"><a href="#temp" class="headerlink" title="temp"></a>temp</h1><p><a target="_blank" rel="noopener" href="http://ip:20030/x_program_center/jest/list.html">http://ip:20030/x_program_center/jest/list.html</a></p><p><a target="_blank" rel="noopener" href="http://ip:20020/x_organization_assemble_authentication/jaxrs/authentication">http://ip:20020/x_organization_assemble_authentication/jaxrs/authentication</a></p><p>OA OAuth2<br><a target="_blank" rel="noopener" href="http://localhost:8090/x_desktop/oauth2.html?redirect_uri=$%7Bredirect_uri%7D&amp;response_type=code&amp;client_id=$%7Bclient_id%7D">http://localhost:8090/x_desktop/oauth2.html?redirect_uri=${redirect_uri}&amp;response_type=code&amp;client_id=${client_id}</a></p><p><a target="_blank" rel="noopener" href="http://localhost:20020/x_organization_assemble_authentication/jaxrs/oauth/token">http://localhost:20020/x_organization_assemble_authentication/jaxrs/oauth/token</a></p><p>SSO 客户端<br><a target="_blank" rel="noopener" href="http://127.0.0.1:8090/x_desktop/sso.html?client=Jira&amp;xtoken=AUWZHInN6nlfYypSxtmVsduQJYPaBA5Ep3PR350NiF4&amp;redirect=$%7Bredirect%7D">http://127.0.0.1:8090/x_desktop/sso.html?client=Jira&amp;xtoken=AUWZHInN6nlfYypSxtmVsduQJYPaBA5Ep3PR350NiF4&amp;redirect=${redirect}</a></p><p>OA SSO POST<br><a target="_blank" rel="noopener" href="http://localhost:20020/x_organization_assemble_authentication/jaxrs/sso">http://localhost:20020/x_organization_assemble_authentication/jaxrs/sso</a></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">POST BODY(JSON)</span><br><span class="line">&#123;</span><br><span class="line">    &quot;client&quot;:&quot;OA 配置名称&quot;,</span><br><span class="line">    &quot;token&quot;:&quot;生成的 TOKEN&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>GET<br><a target="_blank" rel="noopener" href="http://localhost:20020/x_organization_assemble_authentication/jaxrs/sso/client/%7Bclient%7D/token/%7Btoken%7D">http://localhost:20020/x_organization_assemble_authentication/jaxrs/sso/client/{client}/token/{token}</a></p><h1 id="软件破解"><a href="#软件破解" class="headerlink" title="软件破解"></a>软件破解</h1><h2 id="StarUML5"><a href="#StarUML5" class="headerlink" title="StarUML5"></a>StarUML5</h2><p>安装编译工具【asar】：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install -g asar</span><br></pre></td></tr></table></figure><p>反编译，<code>C:\Program Files\StarUML\resources</code> 目录下找到 app.asar，将其复制出来，执行如下命令：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">asar extract app.asar app</span><br></pre></td></tr></table></figure><p>然后打开 <code>app\src\engine\license-manager.js</code>：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 修改验证许可的方法，使其验证成功，不提示</span></span><br><span class="line">checkLicenseValidity () &#123;</span><br><span class="line">  <span class="keyword">if</span> (packageJSON.<span class="property">config</span>.<span class="property">setappBuild</span>) &#123;</span><br><span class="line">    <span class="title function_">setStatus</span>(<span class="variable language_">this</span>, <span class="literal">true</span>)</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">validate</span>().<span class="title function_">then</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="title function_">setStatus</span>(<span class="variable language_">this</span>, <span class="literal">true</span>)</span><br><span class="line">    &#125;, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="title function_">setStatus</span>(<span class="variable language_">this</span>,<span class="literal">true</span>)               <span class="comment">// 原本是false,改成true</span></span><br><span class="line">      <span class="comment">// UnregisteredDialog.showDialog() // 注释掉</span></span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>禁用版本自动更新：<br>修改 <code>app/src/app-context.js</code> 中的 appReady 方法，注释部分代码。代码在713行。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (!<span class="variable language_">this</span>.<span class="property">config</span>.<span class="property">setappBuild</span>) &#123;</span><br><span class="line">    <span class="comment">/* 禁用自动更新，注释掉此处if语句块</span></span><br><span class="line"><span class="comment">        if (this.preferences.get(&#x27;checkUpdate.checkUpdateOnStart&#x27;)) &#123;</span></span><br><span class="line"><span class="comment">        ipcRenderer.send(&#x27;check-update&#x27;)</span></span><br><span class="line"><span class="comment">        &#125;</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>修改了源码，需要重新打包源码。生效修改的部分。运行以下命令：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">asar pack app app.asar</span><br></pre></td></tr></table></figure><p>重新打开 StarUML，【不提示需要注册和没有 Unregistered 标识】则表示破解成功。</p><h2 id="jira"><a href="#jira" class="headerlink" title="jira"></a>jira</h2><p>jira 破解：<code>java -jar atlassian-agent.jar -p jira -m aaa@bbb.com -n my_name -o JRPJZ -s ABCD-1234-EFGH-5678</code></p><h2 id="confluence"><a href="#confluence" class="headerlink" title="confluence"></a>confluence</h2><p>confluence 破解：<code>java -jar atlassian-agent.jar -p conf -m aaa@bbb.com -n my_name -o JRPJZ -s ABCD-1234-EFGH-5678</code></p><h1 id="vim"><a href="#vim" class="headerlink" title="vim"></a>vim</h1><p>柜台<br><c-a>增加数量<br><c-x>减少数量<br>&lt;C-]&gt; 跳转到定义<br>g] 查看所有定义<br><c-t>返回上一个标签</c-t></c-x></c-a></p><p><code>^ 插入模式下光标的最后位置</code>. 当前缓冲区的最后更改<br><code>&quot; 最后退出的当前缓冲区</code>0 在上次编辑的文件中<br>‘’ 返回当前缓冲区中跳转的行<br>&#96;&#96; 返回当前缓冲区中跳转的位置<br><code>[ 到先前更改或猛拉的文本的开头</code>] 结束先前更改或猛拉的文本<br><code>&lt; 到最后一个视觉选择的开始</code>&gt; 到最后一个视觉选择结束<br>ma 将此光标位置标记为 a<br><code>a 跳转到光标位置 a &#39;a 跳到带有位置的行的开头 a d&#39;a 从当前行删除到标记行 a d</code>a 从当前位置删除到标记位置 a<br>c’a 将文本从当前行更改为 a<br>y&#96;a 将文本从当前位置拉到 a</p><h3 id="vimrc1"><a href="#vimrc1" class="headerlink" title="vimrc1"></a>vimrc1</h3><p>“ &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;<br>“ 功能函数<br>“ &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;<br>“ 获取当前目录<br>func GetPWD()<br>return substitute(getcwd(), “”, “”, “g”)<br>endf</p><p>“ &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;<br>“ 多语言环境<br>“ 默认为 UTF-8 编码<br>“ &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;<br>if has(“multi_byte”)<br>set encoding&#x3D;utf-8<br>“ English messages only<br>“language messages zh_CN.utf-8</p><pre><code>if has(&#39;win32&#39;)
    language english
    let &amp;termencoding=&amp;encoding
endif

set fencs=utf-8,gbk,chinese,latin1
set formatoptions+=mM
set nobomb &quot; 不使用 Unicode 签名

if v:lang =~? &#39;^\(zh\)\|\(ja\)\|\(ko\)&#39;
    set ambiwidth=double
endif
</code></pre><p>else<br>echoerr “Sorry, this version of (g)vim was not compiled with +multi_byte”<br>endif</p><p>“ &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;<br>“ 环境配置<br>“ &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;</p><p>“ 保留历史记录<br>set history&#x3D;400</p><p>“ 命令行于状态行<br>set ch&#x3D;1<br>set stl&#x3D;\ [File]\ %F%m%r%h%y[%{&amp;fileformat},%{&amp;fileencoding}]\ %w\ \ [PWD]\ %r%{GetPWD()}%h\ %&#x3D;\ [Line]\ %l,%c\ %&#x3D;\ %P<br>set ls&#x3D;2 “ 始终显示状态行</p><p>“ 行控制<br>set linebreak<br>set nocompatible<br>set textwidth&#x3D;80<br>set wrap</p><p>“ 控制台响铃<br>:set noerrorbells<br>:set novisualbell<br>:set t_vb&#x3D; “close visual bell</p><p>“ 插入模式下使用<bs>、<del><c-w><c-u><br>set backspace&#x3D;indent,eol,start</c-u></c-w></del></bs></p><p>“ 自动重新读入<br>set autoread</p><p>“代码折叠<br>“设置折叠模式<br>set foldcolumn&#x3D;4<br>“光标遇到折叠，折叠就打开<br>“set foldopen&#x3D;all<br>“移开折叠时自动关闭折叠<br>“set foldclose&#x3D;all<br>“zf zo zc zd zr zm zR zM zn zi zN<br>“依缩进折叠<br>“ manual 手工定义折叠<br>“ indent 更多的缩进表示更高级别的折叠<br>“ expr 用表达式来定义折叠<br>“ syntax 用语法高亮来定义折叠<br>“ diff 对没有更改的文本进行折叠<br>“ marker 对文中的标志折叠<br>set foldmethod&#x3D;syntax<br>“启动时不要自动折叠代码<br>set foldlevel&#x3D;100<br>“依标记折叠<br>set foldmethod&#x3D;marker</p><p>“语法高亮<br>syntax enable<br>syntax on</p><p>“设置配色<br>set guifont&#x3D;Courier\ New:h12<br>colorscheme desert</p><p>“设定文件浏览器目录为当前目录<br>set bsdir&#x3D;buffer</p><p>“ 自动切换到文件当前目录<br>set autochdir</p><p>“显示匹配的括号<br>set showmatch</p><p>“增强模式中的命令行自动完成操作<br>set wildmenu</p><p>“使PHP识别EOT字符串<br>hi link phpheredoc string<br>“php语法折叠<br>let php_folding &#x3D; 1<br>“允许在有未保存的修改时切换缓冲区<br>set hidden</p><p>“实现全能补全功能，需要打开文件类型检测<br>“filetype plugin indent on<br>“打开vim的文件类型自动检测功能<br>“filetype on</p><p>“保存文件的格式顺序<br>set fileformats&#x3D;dos,unix<br>“置粘贴模式，这样粘贴过来的程序代码就不会错位了。<br>set paste</p><p>“在所有模式下都允许使用鼠标，还可以是n,v,i,c等<br>set mouse&#x3D;a</p><p>“ 恢复上次文件打开位置<br>set viminfo&#x3D;’10,&quot;100,:20,%,n~&#x2F;.viminfo<br>au BufReadPost * if line(“‘&quot;“) &gt; 0|if line(“‘&quot;“) &lt;&#x3D; line(“$”)|exe(“norm ‘&quot;“)|else|exe “norm $”|endif|endif</p><p>“取得光标处的匹配<br>function! GetPatternAtCursor(pat)<br>let col &#x3D; col(‘.’) - 1<br>let line &#x3D; getline(‘.’)<br>let ebeg &#x3D; -1<br>let cont &#x3D; match(line, a:pat, 0)<br>while (ebeg &gt;&#x3D; 0 || (0 &lt;&#x3D; cont) &amp;&amp; (cont &lt;&#x3D; col))<br>let contn &#x3D; matchend(line, a:pat, cont)<br>if (cont &lt;&#x3D; col) &amp;&amp; (col &lt; contn)<br>let ebeg &#x3D; match(line, a:pat, cont)<br>let elen &#x3D; contn - ebeg<br>break<br>else<br>let cont &#x3D; match(line, a:pat, contn)<br>endif<br>endwh<br>if ebeg &gt;&#x3D; 0<br>return strpart(line, ebeg, elen)<br>else<br>return “”<br>endif<br>endfunction</p><p>“ &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;<br>“ 图形界面<br>“ &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;<br>if has(‘gui_running’)<br>“ 只显示菜单<br>set guioptions&#x3D;mcr</p><pre><code>&quot; 高亮光标所在的行
set cursorline

&quot; 编辑器配色
colorscheme desert
&quot;colorscheme zenburn
&quot;colorscheme dusk

if has(&quot;win32&quot;)
    &quot; Windows 兼容配置
    source $VIMRUNTIME/vimrc_example.vim
    source $VIMRUNTIME/mswin.vim

    &quot;设置鼠标运行模式为WINDOWS模式
    behave mswin

    &quot; f11 最大化
    map &lt;f11&gt; :call libcallnr(&#39;fullscreen.dll&#39;, &#39;ToggleFullScreen&#39;, 0)&lt;cr&gt;

    &quot; 字体配置
    exec &#39;set guifont=&#39;.iconv(&#39;Courier_New&#39;, &amp;enc, &#39;gbk&#39;).&#39;:h12:cANSI&#39;
    &quot;exec &#39;set guifontwide=&#39;.iconv(&#39;微软雅黑&#39;, &amp;enc, &#39;gbk&#39;).&#39;:h12&#39;
endif

if has(&quot;unix&quot;) &amp;&amp; !has(&#39;gui_macvim&#39;)
    set guifont=Courier\ 10\ Pitch\ 11
    set guifontwide=YaHei\ Consolas\ Hybrid\ 11
endif

if has(&quot;mac&quot;) || has(&quot;gui_macvim&quot;)
    set guifont=Courier\ New:h16.00
    &quot;set guifontwide=YaHei\ Consolas\ Hybrid:h16.00
    &quot;set guifont=Monaco:h16
    &quot;set guifont=Droid\ Sans\ Mono:h14
    set guifontwide=YouYuan:h14
    if has(&quot;gui_macvim&quot;)
        &quot;set transparency=4
        set lines=200 columns=142

        let s:lines=&amp;lines
        let s:columns=&amp;columns
        func! FullScreenEnter()
            set lines=999 columns=999
            set fu
        endf

        func! FullScreenLeave()
            let &amp;lines=s:lines
            let &amp;columns=s:columns
            set nofu
        endf

        func! FullScreenToggle()
            if &amp;fullscreen
                call FullScreenLeave()
            else
                call FullScreenEnter()
            endif
        endf
    endif
endif
</code></pre><p>endif</p><p>“ Under the Mac(MacVim)<br>if has(“gui_macvim”)</p><pre><code>&quot; Mac 下，按 \ff 切换全屏
map &lt;Leader&gt;&lt;Leader&gt;  :call FullScreenToggle()&lt;cr&gt;

&quot; Set input method off
set imdisable

&quot; Set QuickTemplatePath
let g:QuickTemplatePath = $HOME.&#39;/.vim/templates/&#39;

lcd ~/Desktop/

&quot; 自动切换到文件当前目录
set autochdir

&quot; Set QuickTemplatePath
let g:QuickTemplatePath = $HOME.&#39;/.vim/templates/&#39;
</code></pre><p>endif</p><p>“设置VIM状态栏<br>set laststatus&#x3D;2 “显示状态栏(默认值为1, 无法显示状态栏)<br>set statusline&#x3D; “[%F]%y%r%m%<em>%&#x3D;[Line:%l&#x2F;%L,Column:%c][%p%%]<br>set statusline+&#x3D;%2</em>%-3.3n%0<em>\ “ buffer number<br>set statusline+&#x3D;%f\ “ file name<br>set statusline+&#x3D;%h%1</em>%m%r%w%0* “ flag<br>set statusline+&#x3D;[<br>if v:version &gt;&#x3D; 600<br>set statusline+&#x3D;%{strlen(&amp;ft)?&amp;ft:’none’}, “ filetype<br>set statusline+&#x3D;%{&amp;fileencoding}, “ encoding<br>endif<br>set statusline+&#x3D;%{&amp;fileformat}] “ file format<br>set statusline+&#x3D;%&#x3D; “ right align<br>“set statusline+&#x3D;%2*0x%-8B\ “ current char<br>set statusline+&#x3D;0x%-8B\ “ current char<br>set statusline+&#x3D;%-14.(%l,%c%V%)\ %&lt;%P “ offset<br>if filereadable(expand(“~&#x2F;vimfiles&#x2F;plugin&#x2F;vimbuddy.vim”))<br>set statusline+&#x3D;\ %{VimBuddy()} “ vim buddy<br>endif</p><p>“ &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;<br>“ 插件<br>“ &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;<br>filetype plugin indent on</p><p>“html自动输入匹配标签，输入&gt;之后自动完成匹配标签<br>au FileType xhtml,xml so ~&#x2F;.vim&#x2F;plugin&#x2F;html_autoclosetag.vim</p><p>“Auto completion using the TAB key “ 自动补全括号，引号<br>“This function determines, wether we are on<br>“the start of the line text(then tab indents)<br>“or if we want to try auto completion<br>function! InsertTabWrapper()<br>let col&#x3D;col(‘.’)-1<br>if !col || getline(‘.’)[col-1] !~ ‘\k’<br>return “&lt;TAB&gt;”<br>else<br>return “&lt;C-N&gt;”<br>endif<br>endfunction</p><p>“Remap the tab key to select action with InsertTabWrapper<br>inoremap<tab><c-r>&#x3D;InsertTabWrapper()<cr></cr></c-r></tab></p><p>:inoremap ( ()<esc>i<br>:inoremap )<c-r>&#x3D;ClosePair(‘)’)<cr><br>:inoremap { {}<esc>i<br>:inoremap }<c-r>&#x3D;ClosePair(‘}’)<cr><br>:inoremap [ []<esc>i<br>:inoremap ]<c-r>&#x3D;ClosePair(‘]’)<cr><br>:inoremap &lt; &lt;&gt;<esc>i<br>:inoremap &gt;<c-r>&#x3D;ClosePair(‘&gt;’)<cr><br>:inoremap “ “”<esc>i<br>:inoremap ‘ ‘’<esc>i<br>function! ClosePair(char)<br>if getline(‘.’)[col(‘.’) - 1] &#x3D;&#x3D; a:char<br>return “&lt;Right&gt;”<br>else<br>return a:char<br>endif<br>endf<br>“ &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;<br>“ AutoCmd<br>“ &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;<br>if has(“autocmd”)<br>filetype plugin indent on</esc></esc></cr></c-r></esc></cr></c-r></esc></cr></c-r></esc></cr></c-r></esc></p><pre><code>&quot; 括号自动补全
func! AutoClose()
    :inoremap ( ()&lt;ESC&gt;i
    &quot;:inoremap &quot; &quot;&quot;&lt;ESC&gt;i
    &quot;:inoremap &#39; &#39;&#39;&lt;ESC&gt;i
    :inoremap &#123; &#123;&#125;&lt;ESC&gt;i
    :inoremap [ []&lt;ESC&gt;i
    :inoremap ) &lt;c-r&gt;=ClosePair(&#39;)&#39;)&lt;CR&gt;
    :inoremap &#125; &lt;c-r&gt;=ClosePair(&#39;&#125;&#39;)&lt;CR&gt;
    :inoremap ] &lt;c-r&gt;=ClosePair(&#39;]&#39;)&lt;CR&gt;
endf

func! ClosePair(char)
    if getline(&#39;.&#39;)[col(&#39;.&#39;) - 1] == a:char
        return &quot;\&lt;Right&gt;&quot;
    else
        return a:char
    endif
endf

augroup vimrcEx
    au!
    autocmd FileType text setlocal textwidth=80
    autocmd BufReadPost *
                \ if line(&quot;&#39;\&quot;&quot;) &gt; 0 &amp;&amp; line(&quot;&#39;\&quot;&quot;) &lt;= line(&quot;$&quot;) |
                \   exe &quot;normal g`\&quot;&quot; |
                \ endif
augroup END

&quot;auto close quotation marks for PHP, Javascript, etc, file
au FileType php,c,python,javascript exe AutoClose()

&quot; Auto Check Syntax
au BufWritePost,FileWritePost *.js,*.php call CheckSyntax(1)

&quot; JavaScript 语法高亮
au FileType html,javascript let g:javascript_enable_domhtmlcss = 1

&quot; 给 Javascript 文件添加 Dict
if has(&#39;gui_macvim&#39;) || has(&#39;unix&#39;)
    au FileType javascript setlocal dict+=~/.vim/dict/javascript.dict
else 
    au FileType javascript setlocal dict+=$VIM/vimfiles/dict/javascript.dict
endif

&quot; 格式化 JavaScript 文件
&quot;au FileType javascript map &lt;f12&gt; :call g:Jsbeautify()&lt;cr&gt;
au FileType javascript set omnifunc=javascriptcomplete#CompleteJS

&quot; 给 CSS 文件添加 Dict
if has(&#39;gui_macvim&#39;) || has(&#39;unix&#39;)
    au FileType css setlocal dict+=~/.vim/dict/css.dict
else
    au FileType css setlocal dict+=$VIM/vimfiles/dict/css.dict
endif

&quot; 增加 ActionScript 语法支持
au BufNewFile,BufRead *.as setf actionscript 

&quot; 自动最大化窗口
if has(&#39;gui_running&#39;)
    if has(&quot;win32&quot;)
        au GUIEnter * simalt ~x
    &quot;elseif has(&quot;unix&quot;)
        &quot;au GUIEnter * winpos 0 0
        &quot;set lines=999 columns=999
    endif
endif
</code></pre><p>endif</p><p>let g:SuperTabDefaultCompletionType &#x3D; ‘<c-x><c-u>‘<br>let g:SuperTabDefaultCompletionType &#x3D; “context”<br>let g:SuperTabRetainCompletionType&#x3D;2<br>“ Disable AutoComplPop.<br>let g:acp_enableAtStartup &#x3D; 0</c-u></c-x></p><p>“ Use neocomplcache.<br>let g:neocomplcache_enable_at_startup &#x3D; 1<br>“ Use smartcase.<br>let g:neocomplcache_enable_smart_case &#x3D; 1<br>“ Use camel case completion.<br>let g:neocomplcache_enable_camel_case_completion &#x3D; 1<br>“ Use underbar completion.<br>let g:neocomplcache_enable_underbar_completion &#x3D; 1<br>“ Set minimum syntax keyword length.<br>let g:neocomplcache_min_syntax_length &#x3D; 3<br>let g:neocomplcache_lock_buffer_name_pattern &#x3D; ‘*ku*‘</p><p>“ Define dictionary.<br>let g:neocomplcache_dictionary_filetype_lists &#x3D; {<br>\ ‘default’ : ‘’,<br>\ ‘css’ : ‘<del>&#x2F;.vim&#x2F;dist&#x2F;css.dic’,<br>\ ‘php’ : ‘</del>&#x2F;.vim&#x2F;dict&#x2F;php.dic’,<br>\ ‘javascript’ : ‘<del>&#x2F;.vim&#x2F;dict&#x2F;javascript.dic’,<br>\ ‘vimshell’ : $HOME.’&#x2F;.vimshell_hist’,<br>\ ‘scheme’ : $HOME.’&#x2F;.gosh_completions’<br>\ }<br>let g:neocomplcache_snippets_dir&#x3D;”</del>&#x2F;.vim&#x2F;snippets”<br>inoremap<expr><tab>pumvisible() ? “&lt;C-n&gt;” : “&lt;TAB&gt;”<br>inoremap<expr><s-tab>pumvisible() ? “&lt;C-p&gt;” : “&lt;TAB&gt;”</s-tab></expr></tab></expr></p><p>“ Define keyword.<br>if !exists(‘g:neocomplcache_keyword_patterns’)<br>let g:neocomplcache_keyword_patterns &#x3D; {}<br>endif<br>let g:neocomplcache_keyword_patterns[‘default’] &#x3D; ‘\h\w*’</p><p>“ Plugin key-mappings.<br>imap<c-k><plug>(neocomplcache_snippets_expand)<br>smap<c-k><plug>(neocomplcache_snippets_expand)<br>inoremap<expr><c-g>neocomplcache#undo_completion()<br>inoremap<expr><c-l>neocomplcache#complete_common_string()</c-l></expr></c-g></expr></plug></c-k></plug></c-k></p><p>“ Recommended key-mappings.<br>“<cr>: close popup and save indent.<br>inoremap<expr><cr>neocomplcache#smart_close_popup() . “&lt;CR&gt;”<br>“<tab>: completion.<br>inoremap<expr><tab>pumvisible() ? “&lt;C-n&gt;” : “&lt;TAB&gt;”<br>“<c-h>,<bs>: close popup and delete backword char.<br>inoremap<expr><c-h>neocomplcache#smart_close_popup().”&lt;C-h&gt;”<br>inoremap<expr><bs>neocomplcache#smart_close_popup().”&lt;C-h&gt;”<br>inoremap<expr><c-y>neocomplcache#close_popup()<br>inoremap<expr><c-e>neocomplcache#cancel_popup()</c-e></expr></c-y></expr></bs></expr></c-h></expr></bs></c-h></tab></expr></tab></cr></expr></cr></p><p>“ AutoComplPop like behavior.<br>“let g:neocomplcache_enable_auto_select &#x3D; 1</p><p>“ Shell like behavior(not recommended).<br>“set completeopt+&#x3D;longest<br>let g:neocomplcache_enable_auto_select &#x3D; 1<br>let g:neocomplcache_disable_auto_complete &#x3D; 1<br>inoremap<expr><tab>pumvisible() ? “&lt;Down&gt;” : “&lt;TAB&gt;”<br>inoremap<expr><cr>neocomplcache#smart_close_popup() . “&lt;CR&gt;”</cr></expr></tab></expr></p><p>“ Enable omni completion.<br>autocmd FileType css setlocal omnifunc&#x3D;csscomplete#CompleteCSS<br>autocmd FileType html,markdown setlocal omnifunc&#x3D;htmlcomplete#CompleteTags<br>autocmd FileType javascript setlocal omnifunc&#x3D;javascriptcomplete#CompleteJS<br>autocmd FileType python setlocal omnifunc&#x3D;pythoncomplete#Complete<br>autocmd FileType xml setlocal omnifunc&#x3D;xmlcomplete#CompleteTags</p><p>“ Enable heavy omni completion.<br>if !exists(‘g:neocomplcache_omni_patterns’)<br>let g:neocomplcache_omni_patterns &#x3D; {}<br>endif<br>let g:neocomplcache_omni_patterns.ruby &#x3D; ‘[^. <em>\t].\w</em>|\h\w*::’<br>“autocmd FileType ruby setlocal omnifunc&#x3D;rubycomplete#Complete<br>let g:neocomplcache_omni_patterns.php &#x3D; ‘[^. \t]-&gt;\h\w<em>|\h\w</em>::’<br>let g:neocomplcache_omni_patterns.c &#x3D; ‘%(.|-&gt;)\h\w*’<br>let g:neocomplcache_omni_patterns.cpp &#x3D; ‘\h\w<em>%(.|-&gt;)\h\w</em>|\h\w*::’</p><p>“”””””””””””””””””””””””””””””<br>“ Tag list (ctags)<br>“”””””””””””””””””””””””””””””<br>if has(“win32”) “设定windows系统中ctags程序的位置<br>let Tlist_Ctags_Cmd &#x3D; ‘ctags’<br>elseif has(“linux”) “设定linux系统中ctags程序的位置<br>let Tlist_Ctags_Cmd &#x3D; ‘&#x2F;usr&#x2F;bin&#x2F;ctags’<br>endif<br>let Tlist_Show_One_File &#x3D; 1 “不同时显示多个文件的tag，只显示当前文件的<br>let Tlist_Exit_OnlyWindow &#x3D; 1 “如果taglist窗口是最后一个窗口，则退出vim<br>let Tlist_Use_Right_Window &#x3D; 1 “在右侧窗口中显示taglist窗口</p><p>“ &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;<br>“ 快捷键<br>“ &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;<br>map cal :Calendar<cr><br>map cse :ColorSchemeExplorer<br>“&#x3D;&#x3D;&#x3D;&#x3D; F3 NERDTree 切换 &#x3D;&#x3D;&#x3D;&#x3D;<br>let NERDTreeWinSize&#x3D;22<br>“map ntree :NERDTree<cr><br>“map nk :NERDTreeClose<cr><br>“map<leader>n :NERDTreeToggle<cr><br>map<f3>:NERDTreeToggle<cr><br>imap<f3><esc>:NERDTreeToggle<cr><br>“&#x3D;&#x3D;&#x3D;&#x3D; F4 Tag list 切换 &#x3D;&#x3D;&#x3D;&#x3D;<br>map<silent><f4>:TlistToggle<cr></cr></f4></silent></cr></esc></f3></cr></f3></cr></leader></cr></cr></cr></p><p>“ 标签相关的快捷键 Ctrl<br>map tn :tabnext<cr><br>map tp :tabprevious<cr><br>map tc :tabclose<cr><br>map<c-t>:tabnew<cr><br>map<c-p>:tabprevious<cr><br>map<c-n>:tabnext<cr><br>map<c-k>:tabclose<cr><br>map<c-tab>:tabnext<cr></cr></c-tab></cr></c-k></cr></c-n></cr></c-p></cr></c-t></cr></cr></cr></p><p>“ 新建 XHTML 、PHP、Javascript 文件的快捷键<br>nmap<c-c><c-h>:NewQuickTemplateTab xhtml<cr><br>nmap<c-c><c-p>:NewQuickTemplateTab php<cr><br>nmap<c-c><c-j>:NewQuickTemplateTab javascript<cr><br>nmap<c-c><c-c>:NewQuickTemplateTab css<cr></cr></c-c></c-c></cr></c-j></c-c></cr></c-p></c-c></cr></c-h></c-c></p><p>“ 在文件名上按gf时，在新的tab中打开<br>map gf :tabnew<cfile><cr></cr></cfile></p><p>“jquery 配色<br>au BufRead,BufNewFile *.js set syntax&#x3D;jquery</p><p>“ jsLint for Vim<br>let g:jslint_highlight_color &#x3D; ‘#996600’<br>“ 指定 jsLint 调用路径，通常不用更改<br>let g:jslint_command &#x3D; $HOME . ‘/.vim/jsl/jsl’<br>“ 指定 jsLint 的启动参数，可以指定相应的配置文件<br>let g:jslint_command_options &#x3D; ‘-nofilelisting -nocontext -nosummary -nologo -process’</p><p>“缺省不产生备份文件<br>set nobackup<br>set nowritebackup</p><p>“ autoload _vimrc<br>autocmd! bufwritepost _vimrc source %</p><p>“ &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;<br>“ plugin list<br>“ &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;<br>“Color Scheme Explorer<br>“jsbeauty \ff<br>“NERDTree<br>“Calendar<br>“conquer_term<br>“nerd_commenter</p><p>“&#x2F;*&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;<em><br>“ 常用指令收集<br>“*&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;</em>&#x2F;<br>“ 系统时间<br>“ :map<f7>a<c-r>&#x3D;strftime(“%c”)<cr><esc><br>“ :s&#x2F;<strong>date</strong>&#x2F;=strftime(“%c”)&#x2F;</esc></cr></c-r></f7></p><p>“&#x2F;*—————————————<em><br>“ 基础命令<br>“&#x2F;</em>—————————————*<br>“ ctrl+q 可以联合复制，粘贴，替换用 行操作<br>“ ctrl+w+j ctrl+w+k (:bn :bp :bd)</p><p>“ ‘. 它移动光标到上一次的修改行<br>“ &#96;. 它移动光标到上一次的修改点<br>“ . 重复上次命令<br>“<c-o>: 依次沿着你的跳转记录向回跳 (从最近的一次开始)<br>“<c-i>: 依次沿着你的跳转记录向前跳<br>“ ju(mps) : 列出你跳转的足迹<br>“ :history : 列出历史命令记录<br>“ :his c : 命令行命令历史<br>“ :his s : 搜索命令历史<br>“ q&#x2F; : 搜索命令历史的窗口<br>“ q: : 命令行命令历史的窗口<br>“ g ctrl+g 计算文件字符<br>“ {,} 前进至上一段落前进至后一段落<br>“ gg,G(2G) 文件首<br>“ gd dw gf ga(进制转化)<br>“ gg&#x3D;G 全篇自动缩进 , &#x3D;G 单行缩进</c-i></c-o></p><p>“* ci[ 删除一对 [] 中的所有字符并进入插入模式<br>“* ci( 删除一对 () 中的所有字符并进入插入模式<br>“* ci&lt; 删除一对 &lt;&gt; 中的所有字符并进入插入模式<br>“* ci{ 删除一对 {} 中的所有字符并进入插入模式<br>“* cit 删除一对 HTML&#x2F;XML 的标签内部的所有字符并进入插入模式<br>“* ci” ci’ ci<code>删除一对引号字符 (” 或 ‘ 或</code>) 中所有字符并进入插入模式<br>“<br>“* vi[ 选择一对 [] 中的所有字符<br>“* vi( 选择一对 () 中的所有字符<br>“* vi&lt; 选择一对 &lt;&gt; 中的所有字符<br>“* vi{ 选择一对 {} 中的所有字符<br>“* vit 选择一对 HTML&#x2F;XML 的标签内部的所有字符<br>“* vi” vi’ vi<code>选择一对引号字符 (” 或 ‘ 或</code>) 中所有字符</p><p>“ crl+] 函数原型处 crl+t 回 ( ctags )<br>“ ctl+p 自动补全( 编辑状态 )<br>“ :X 加密保存( 要输入密码 )<br>“ ? &#x2F; (N n)<br>“ f(F,t) 查找字符<br>“ w(e) 移动光标到下一个单词.<br>“ 5fx 表示查找光标后第 5 个 x 字符.<br>“ 5w(e) 移动光标到下五个单词.</p><p>“ b 移动光标到上一个单词.<br>“ 0 移动光标到本行最开头.<br>“ ^ 移动光标到本行最开头的字符处.<br>“ $ 移动光标到本行结尾处.<br>“ H 移动光标到屏幕的首行.<br>“ M 移动光标到屏幕的中间一行.<br>“ L 移动光标到屏幕的尾行.</p><p>“ c-f (即 ctrl 键与 f 键一同按下)<br>“ c-b (即 ctrl 键与 b 键一同按下) 翻页<br>“ c-d (下半页) c-u(上半页) c-e (一行滚动)<br>“ zz 让光标所在的行居屏幕中央<br>“ zt 让光标所在的行居屏幕最上一行<br>“ zb 让光标所在的行居屏幕最下一行</p><p>“ 在 vi 中 y 表示拷贝, d 表示删除, p 表示粘贴. 其中拷贝与删除是与光标移动命令<br>“ yw 表示拷贝从当前光标到光标所在单词结尾的内容.<br>“ dw 表示删除从当前光标到光标所在单词结尾的内容.<br>“ y0 表示拷贝从当前光标到光标所在行首的内容.<br>“ d0 表示删除从当前光标到光标所在行首的内容.<br>“ y$(Y) 表示拷贝从当前光标到光标所在行尾的内容.<br>“ d$(D) 表示删除从当前光标到光标所在行尾的内容.<br>“ yfa 表示拷贝从当前光标到光标后面的第一个a字符之间的内容.<br>“ dfa 表示删除从当前光标到光标后面的第一个a字符之间的内容.<br>“ s(S),a(A),x(X),D<br>“ yy 表示拷贝光标所在行.<br>“ dd 表示删除光标所在行.</p><p>“ 5yy 表示拷贝光标以下 5 行.<br>“ 5dd 表示删除光标以下 5 行.<br>“ y2fa 表示拷贝从当前光标到光标后面的第二个a字符之间的内容.<br>“ :12,24y 表示拷贝第12行到第24行之间的内容.<br>“ :12,y 表示拷贝第12行到光标所在行之间的内容.<br>“ :,24y 表示拷贝光标所在行到第24行之间的内容. 删除类似.<br>“ TAB 就是制表符, 单独拿出来做一节是因为这个东西确实很有用.<br>“ &lt;&lt; 输入此命令则光标所在行向左移动一个 tab.<br>“ &gt;&gt; 输入此命令则光标所在行向右移动一个 tab.<br>“ 5&gt;&gt; 输入此命令则光标后 5 行向右移动一个 tab.<br>“ :5&gt;&gt;(&gt;&gt;&gt;) :&gt;&gt;(&gt;&gt;&gt;)5<br>“ :12,24&gt; 此命令将12行到14行的数据都向右移动一个 tab.<br>“ :12,24&gt;&gt; 此命令将12行到14行的数据都向右移动两个 tab.<br>“ :set shiftwidth&#x3D;4 设置自动缩进 4 个空格, 当然要设自动缩进先.<br>“ :set sts&#x3D;4 即设置 softtabstop 为 4. 输入 tab 后就跳了 4 格.<br>“ :set tabstop&#x3D;4 实际的 tab 即为 4 个空格, 而不是缺省的 8 个.<br>“ :set expandtab 在输入 tab 后, vim 用恰当的空格来填充这个 tab.<br>“ :g&#x2F;^&#x2F;exec ‘s&#x2F;^&#x2F;‘.strpart(line(‘.’).’ ‘, 0, 4) 在行首插入行号<br>“ set ai 设置自动缩进<br>“ 5ia<esc>重复插入5个a字符</esc></p><p>“&#x2F;*—————————————<em><br>“ 替换命令<br>“&#x2F;</em>—————————————*<br>“ 替换文字 2009-02-34 —-&gt; 2009-02-34 00:00:00<br>“ :%s&#x2F;(\d{4}-\d{2}-\d{2})&#x2F;\1 00:00:00&#x2F;g</p><p>“ :s&#x2F;aa&#x2F;bb&#x2F;g 将光标所在行出现的所有包含 aa 的字符串中的 aa 替换为 bb<br>“ :s&#x2F;/bb&#x2F;g 将光标所在行出现的所有 aa 替换为 bb, 仅替换 aa 这个单词<br>“ :%s&#x2F;aa&#x2F;bb&#x2F;g 将文档中出现的所有包含 aa 的字符串中的 aa 替换为 bb<br>“ :12,23s&#x2F;aa&#x2F;bb&#x2F;g 将从12行到23行中出现的所有包含 aa 的字符串中的 aa 替换为 bb<br>“ :12,23s&#x2F;^&#x2F;#&#x2F; 将从12行到23行的行首加入 # 字符<br>“ :%s&#x2F;fred&#x2F;joe&#x2F;igc 一个常见的替换命令，修饰符igc和perl中一样意思<br>“ s&#x2F;dick&#x2F;joe&#x2F;igc则 对于这些满足条件的行进行替换</p><p>“ :g&#x2F;^\s*$&#x2F;d 空行(空格也不包含)删除.<br>“ :%s&#x2F;\r&#x2F;&#x2F;g 删除DOS方式的回车^M<br>“ :%s&#x2F; <em>$&#x2F;&#x2F; 删除行尾空白(%s&#x2F;\s</em>$&#x2F;&#x2F;g)<br>“ :g!&#x2F;^dd&#x2F;d 删除不含字符串’dd’开头的行<br>“ :v&#x2F;^dd&#x2F;d 同上,译释：v &#x3D;&#x3D; g!，就是不匹配！<br>“ :v&#x2F;.&#x2F;.,&#x2F;.&#x2F;-1join 压缩空行(多行空行合并为一行)<br>“ :g&#x2F;^$&#x2F;,&#x2F;.&#x2F;-j 压缩空行(多行空行合并为一行)<br>“ :g&#x2F;^&#x2F;pu _ 把文中空行扩增一倍 (pu &#x3D; put),原来两行间有一个空行，现在变成2个<br>“ :g&#x2F;^&#x2F;m0 按行翻转文章 (m &#x3D; move)<br>“ :g&#x2F;fred&#x2F;,&#x2F;joe&#x2F;d not line based (very powerfull)<br>“ :g&#x2F;&lt;input|&lt;form&#x2F;p 或者 要用|<br>“ :g&#x2F;fred&#x2F;t$ 拷贝行，从fred到文件末尾(EOF)</p><p>“ :%norm jdd 隔行删除,译释：%指明是对所有行进行操作,norm指出后面是normal模式的指令,j是下移一行，dd是删除行</p><p>“ :’a,’bg&#x2F;fred&#x2F;s&#x2F;dick&#x2F;joe&#x2F;igc (‘a,’b指定一个范围：mark a ~ mark b)<br>“ g&#x2F;&#x2F;用一个正则表达式指出了进行操作的行必须可以被fred匹配,g&#x2F;&#x2F;是一个全局显示命令</p><p>“ &#x2F;joe&#x2F;e 光标停留在匹配单词最后一个字母处<br>“ &#x2F;joe&#x2F;e+1 光标停留在匹配单词最后一个字母的下一个字母处<br>“ &#x2F;joe&#x2F;s 光标停留在匹配单词第一个字母处<br>“ &#x2F;^joe.*fred.*bill&#x2F; 标准正则表达式<br>“ &#x2F;^[A-J]+&#x2F; 找一个以A~J中一个字母重复两次或以上开头的行<br>“ &#x2F;forum(_.)<em>pent 多行匹配<br>“ &#x2F;fred_s</em>joe&#x2F;i 中间可以有任何空白，包括换行符\n<br>“ &#x2F;fred|joe 匹配FRED或JOE<br>“ &#x2F;&lt;fred&gt;&#x2F;i 匹配fred,fred必须是一个独立的单词，而不是子串<br>“ &#x2F;&lt;\d\d\d\d&gt; 匹配4个数字 &lt;\d{4}&gt;</p><p>“ 列，替换所有在第三列中的str1<br>“ :%s:((\w+\s+){2})str1:\1str2:<br>“ 交换第一列和最后一列 (共4列)<br>“ :%s:(\w+)(.*\s+)(\w+)$:\3\2\1:</p><p>“ 全局(global)显示命令，就是用 :g＋正则表达式<br>“ 译释： :g&#x2F;{pattern}&#x2F;{cmd} 就是全局找到匹配的,然后对这些行执行命令{cmd}<br>“ :g&#x2F;&lt;fred&gt;&#x2F; 显示所有能够为单词fred所匹配的行<br>“ :g&#x2F;<pattern>&#x2F;z#.5 显示内容，还有行号<br>“ :g&#x2F;<pattern>&#x2F;z#.5|echo ‘&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;’ 漂亮的显示</pattern></pattern></p><p>“&#x2F;*—————————————<em><br>“ 多文档操作 (基础)<br>“&#x2F;</em>—————————————*<br>“ 用 :ls! 可以显示出当前所有的buffer<br>“ :bn 跳转到下一个buffer<br>“ :bp 跳转到上一个buffer<br>“ :wn 存盘当前文件并跳转到下一个<br>“ :wp 存盘当前文件并跳转到上一个<br>“ :bd 把这个文件从buffer列表中做掉<br>“ :b 3 跳到第3个buffer<br>“ :b main 跳到一个名字中包含main的buffer</p><p>“&#x2F;*—————————————<em><br>“ 列复制<br>“&#x2F;</em>—————————————*<br>“ 译注：@#%&amp;^#*^%#$!<br>“ :%s&#x3D; [^ ]+$&#x3D;&amp;&amp;&#x3D; : 复制最后一列<br>“ :%s&#x3D; \f+$&#x3D;&amp;&amp;&#x3D; : 一样的功能<br>“ :%s&#x3D; \S+$&#x3D;&amp;&amp; : ft,还是一样<br>“ 反向引用，或称记忆<br>“ :s&#x2F;(.*):(.*)&#x2F;\2 : \1&#x2F; : 颠倒用:分割的两个字段<br>“ :%s&#x2F;^(.*)\n\1&#x2F;\1$&#x2F; : 删除重复行<br>“ 非贪婪匹配，{-}<br>“ :%s&#x2F;^.{-}pdf&#x2F;new.pdf&#x2F; : 只是删除第一个pdf<br>“ 跨越可能的多行<br>“ :%s&#x2F;&#x2F;&#x2F; : 又是删除多行注释（咦？为什么要说「又」呢？）<br>“ :help &#x2F;{-} : 看看关于 非贪婪数量符 的帮助<br>“ :s&#x2F;fred&#x2F;<c-r>a&#x2F;g : 替换fred成register a中的内容，呵呵<br>“ 写在一行里的复杂命令<br>“ :%s&#x2F;\f+.gif&gt;&#x2F;\r&amp;\r&#x2F;g | v&#x2F;.gif$&#x2F;d | %s&#x2F;gif&#x2F;jpg&#x2F;<br>“ 译注：就是用 | 管道啦</c-r></p><p>“&#x2F;*—————————————<em><br>“ 大小写转换<br>“&#x2F;</em>—————————————*<br>“ g~~ : 行翻转<br>“ vEU : 字大写(广义字)<br>“ vE~ : 字翻转(广义字)<br>“ ~ 将光标下的字母改变大小写<br>“ 3~ 将下3个字母改变其大小写<br>“ g~w 字翻转<br>“ U 将可视模式下的字母全改成大写字母<br>“ gUU 将当前行的字母改成大写<br>“ u 将可视模式下的字母全改成小写<br>“ guu 将当前行的字母全改成小写<br>“ gUw 将光标下的单词改成大写。<br>“ guw 将光标下的单词改成小写。</p><p>“ 文件浏览<br>“ :Ex : 开启目录浏览器，注意首字母E是大写的<br>“ :Sex : 在一个分割的窗口中开启目录浏览器<br>“ :ls : 显示当前buffer的情况<br>“ :cd .. : 进入父目录<br>“ :pwd<br>“ :args : 显示目前打开的文件<br>“ :lcd %:p:h : 更改到当前文件所在的目录<br>“ 译释：lcd是紧紧改变当前窗口的工作路径，% 是代表当前文件的文件名,<br>“ 加上 :p扩展成全名（就是带了路径），加上 :h析取出路径</p><p>“&#x2F;*&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;<em><br>“ END<br>“*&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;</em>&#x2F;</p><h3 id="vimrc2"><a href="#vimrc2" class="headerlink" title="vimrc2"></a>vimrc2</h3><p>source ~&#x2F;.vim&#x2F;bundles.vim</p><p>“ encoding dectection<br>set fileencodings&#x3D;utf-8,gb2312,gb18030,gbk,ucs-bom,cp936,latin1</p><p>“ enable filetype dectection and ft specific plugin&#x2F;indent<br>filetype plugin indent on</p><p>“ enable syntax hightlight and completion<br>syntax on</p><p>“——–<br>“ Vim UI<br>“——–<br>“ color scheme<br>set background&#x3D;dark<br>color solarized</p><p>“ highlight current line<br>au WinLeave * set nocursorline nocursorcolumn<br>au WinEnter * set cursorline cursorcolumn<br>set cursorline cursorcolumn</p><p>“ search<br>set incsearch<br>“set highlight “ conflict with highlight current line<br>set ignorecase<br>set smartcase</p><p>“ editor settings<br>set history&#x3D;1000<br>set nocompatible<br>set nofoldenable “ disable folding”<br>set confirm “ prompt when existing from an unsaved file<br>set backspace&#x3D;indent,eol,start “ More powerful backspacing<br>set t_Co&#x3D;256 “ Explicitly tell vim that the terminal has 256 colors “<br>set mouse&#x3D;a “ use mouse in all modes<br>set report&#x3D;0 “ always report number of lines changed “<br>set nowrap “ dont wrap lines<br>set scrolloff&#x3D;5 “ 5 lines above&#x2F;below cursor when scrolling<br>set number “ show line numbers<br>set showmatch “ show matching bracket (briefly jump)<br>set showcmd “ show typed command in status bar<br>set title “ show file in titlebar<br>set laststatus&#x3D;2 “ use 2 lines for the status bar<br>set matchtime&#x3D;2 “ show matching bracket for 0.2 seconds<br>set matchpairs+&#x3D;&lt;:&gt; “ specially for html<br>“ set relativenumber</p><p>“ Default Indentation<br>set autoindent<br>set smartindent “ indent when<br>set tabstop&#x3D;4 “ tab width<br>set softtabstop&#x3D;4 “ backspace<br>set shiftwidth&#x3D;4 “ indent width<br>“ set textwidth&#x3D;79<br>“ set smarttab<br>set expandtab “ expand tab to space</p><p>autocmd FileType php setlocal tabstop&#x3D;2 shiftwidth&#x3D;2 softtabstop&#x3D;2 textwidth&#x3D;120<br>autocmd FileType ruby setlocal tabstop&#x3D;2 shiftwidth&#x3D;2 softtabstop&#x3D;2 textwidth&#x3D;120<br>autocmd FileType php setlocal tabstop&#x3D;4 shiftwidth&#x3D;4 softtabstop&#x3D;4 textwidth&#x3D;120<br>autocmd FileType coffee,javascript setlocal tabstop&#x3D;2 shiftwidth&#x3D;2 softtabstop&#x3D;2 textwidth&#x3D;120<br>autocmd FileType python setlocal tabstop&#x3D;4 shiftwidth&#x3D;4 softtabstop&#x3D;4 textwidth&#x3D;120<br>autocmd FileType html,htmldjango,xhtml,haml setlocal tabstop&#x3D;2 shiftwidth&#x3D;2 softtabstop&#x3D;2 textwidth&#x3D;0<br>autocmd FileType sass,scss,css setlocal tabstop&#x3D;2 shiftwidth&#x3D;2 softtabstop&#x3D;2 textwidth&#x3D;120</p><p>“ syntax support<br>autocmd Syntax javascript set syntax&#x3D;jquery “ JQuery syntax support<br>“ js<br>let g:html_indent_inctags &#x3D; “html,body,head,tbody”<br>let g:html_indent_script1 &#x3D; “inc”<br>let g:html_indent_style1 &#x3D; “inc”</p><p>“—————–<br>“ Plugin settings<br>“—————–<br>“ Rainbow parentheses for Lisp and variants<br>let g:rbpt_colorpairs &#x3D; [<br>\ [‘brown’, ‘RoyalBlue3’],<br>\ [‘Darkblue’, ‘SeaGreen3’],<br>\ [‘darkgray’, ‘DarkOrchid3’],<br>\ [‘darkgreen’, ‘firebrick3’],<br>\ [‘darkcyan’, ‘RoyalBlue3’],<br>\ [‘darkred’, ‘SeaGreen3’],<br>\ [‘darkmagenta’, ‘DarkOrchid3’],<br>\ [‘brown’, ‘firebrick3’],<br>\ [‘gray’, ‘RoyalBlue3’],<br>\ [‘black’, ‘SeaGreen3’],<br>\ [‘darkmagenta’, ‘DarkOrchid3’],<br>\ [‘Darkblue’, ‘firebrick3’],<br>\ [‘darkgreen’, ‘RoyalBlue3’],<br>\ [‘darkcyan’, ‘SeaGreen3’],<br>\ [‘darkred’, ‘DarkOrchid3’],<br>\ [‘red’, ‘firebrick3’],<br>\ ]<br>let g:rbpt_max &#x3D; 16<br>autocmd Syntax lisp,scheme,clojure,racket RainbowParenthesesToggle</p><p>“ tabbar<br>let g:Tb_MaxSize &#x3D; 2<br>let g:Tb_TabWrap &#x3D; 1</p><p>hi Tb_Normal guifg&#x3D;white ctermfg&#x3D;white<br>hi Tb_Changed guifg&#x3D;green ctermfg&#x3D;green<br>hi Tb_VisibleNormal ctermbg&#x3D;252 ctermfg&#x3D;235<br>hi Tb_VisibleChanged guifg&#x3D;green ctermbg&#x3D;252 ctermfg&#x3D;white</p><p>“ easy-motion<br>let g:EasyMotion_leader_key &#x3D; ‘<leader>‘</leader></p><p>“ Tagbar<br>let g:tagbar_left&#x3D;1<br>let g:tagbar_width&#x3D;30<br>let g:tagbar_autofocus &#x3D; 1<br>let g:tagbar_sort &#x3D; 0<br>let g:tagbar_compact &#x3D; 1<br>“ tag for coffee<br>if executable(‘coffeetags’)<br>let g:tagbar_type_coffee &#x3D; {<br>\ ‘ctagsbin’ : ‘coffeetags’,<br>\ ‘ctagsargs’ : ‘’,<br>\ ‘kinds’ : [<br>\ ‘f:functions’,<br>\ ‘o:object’,<br>\ ],<br>\ ‘sro’ : “.”,<br>\ ‘kind2scope’ : {<br>\ ‘f’ : ‘object’,<br>\ ‘o’ : ‘object’,<br>\ }<br>\ }</p><p>let g:tagbar_type_markdown &#x3D; {<br>\ ‘ctagstype’ : ‘markdown’,<br>\ ‘sort’ : 0,<br>\ ‘kinds’ : [<br>\ ‘h:sections’<br>\ ]<br>\ }<br>endif</p><p>“ Nerd Tree<br>let NERDChristmasTree&#x3D;0<br>let NERDTreeWinSize&#x3D;30<br>let NERDTreeChDirMode&#x3D;2<br>let NERDTreeIgnore&#x3D;[‘~$’, ‘.pyc$’, ‘.swp$’]<br>“ let NERDTreeSortOrder&#x3D;[‘^__.py$’, ‘/$’, ‘*’, ‘.swp$’, ‘~$’]<br>let NERDTreeShowBookmarks&#x3D;1<br>let NERDTreeWinPos &#x3D; “right”</p><p>“ nerdcommenter<br>let NERDSpaceDelims&#x3D;1<br>“ nmap<d->:NERDComToggleComment<cr><br>let NERDCompactSexyComs&#x3D;1</cr></p><p>“ ZenCoding<br>let g:user_emmet_expandabbr_key&#x3D;’<c-j>‘</c-j></p><p>“ powerline<br>“let g:Powerline_symbols &#x3D; ‘fancy’</p><p>“ NeoComplCache<br>let g:neocomplcache_enable_at_startup&#x3D;1<br>let g:neoComplcache_disableautocomplete&#x3D;1<br>“let g:neocomplcache_enable_underbar_completion &#x3D; 1<br>“let g:neocomplcache_enable_camel_case_completion &#x3D; 1<br>let g:neocomplcache_enable_smart_case&#x3D;1<br>let g:neocomplcache_min_syntax_length &#x3D; 3<br>let g:neocomplcache_lock_buffer_name_pattern &#x3D; ‘*ku*‘<br>set completeopt-&#x3D;preview</p><p>imap<c-k><plug>(neocomplcache_snippets_force_expand)<br>smap<c-k><plug>(neocomplcache_snippets_force_expand)<br>imap<c-l><plug>(neocomplcache_snippets_force_jump)<br>smap<c-l><plug>(neocomplcache_snippets_force_jump)</plug></c-l></plug></c-l></plug></c-k></plug></c-k></p><p>“ Enable omni completion.<br>autocmd FileType css setlocal omnifunc&#x3D;csscomplete#CompleteCSS<br>autocmd FileType html,markdown setlocal omnifunc&#x3D;htmlcomplete#CompleteTags<br>autocmd FileType javascript setlocal omnifunc&#x3D;javascriptcomplete#CompleteJS<br>autocmd FileType python setlocal omnifunc&#x3D;pythoncomplete#Complete<br>autocmd FileType c setlocal omnifunc&#x3D;ccomplete#Complete<br>if !exists(‘g:neocomplcache_omni_patterns’)<br>let g:neocomplcache_omni_patterns &#x3D; {}<br>endif<br>let g:neocomplcache_omni_patterns.erlang &#x3D; ‘[a-zA-Z]|:’</p><p>“ SuperTab<br>“ let g:SuperTabDefultCompletionType&#x3D;’context’<br>let g:SuperTabDefaultCompletionType &#x3D; ‘<c-x><c-u>‘<br>let g:SuperTabRetainCompletionType&#x3D;2</c-u></c-x></p><p>“ ctrlp<br>set wildignore+&#x3D;<em>&#x2F;tmp&#x2F;</em>,<em>.so,</em>.o,<em>.a,</em>.obj,<em>.swp,</em>.zip,<em>.pyc,</em>.pyo,*.class,.DS_Store “ MacOSX&#x2F;Linux<br>let g:ctrlp_custom_ignore &#x3D; ‘.git$|.hg$|.svn$’</p><p>“ Keybindings for plugin toggle<br>nnoremap<f2>:set invpaste paste?<cr><br>set pastetoggle&#x3D;<f2><br>nmap<f5>:TagbarToggle<cr><br>nmap<f6>:NERDTreeToggle<cr><br>nmap<f3>:GundoToggle<cr><br>nmap<f4>:IndentGuidesToggle<cr><br>nmap<d->:<br>nnoremap<leader>a :Ack<br>nnoremap<leader>v V&#96;]</leader></leader></cr></f4></cr></f3></cr></f6></cr></f5></f2></cr></f2></p><p>“——————<br>“ Useful Functions<br>“——————<br>“ easier navigation between split windows<br>nnoremap<c-j><c-w>j<br>nnoremap<c-k><c-w>k<br>nnoremap<c-h><c-w>h<br>nnoremap<c-l><c-w>l</c-w></c-l></c-w></c-h></c-w></c-k></c-w></c-j></p><p>“ When editing a file, always jump to the last cursor position<br>autocmd BufReadPost *<br>\ if ! exists(“g:leave_my_cursor_position_alone”) |<br>\ if line(“‘&quot;“) &gt; 0 &amp;&amp; line (“‘&quot;“) &lt;&#x3D; line(“$”) |<br>\ exe “normal g’&quot;“ |<br>\ endif |<br>\ endif</p><p>“ w!! to sudo &amp; write a file<br>cmap w!! %!sudo tee &gt;&#x2F;dev&#x2F;null %</p><p>“ Quickly edit&#x2F;reload the vimrc file<br>nmap<silent><leader>ev :e $MYVIMRC<cr><br>nmap<silent><leader>sv :so $MYVIMRC<cr></cr></leader></silent></cr></leader></silent></p><p>“ sublime key bindings<br>nmap &lt;D-]&gt; &gt;&gt;<br>nmap &lt;D-[&gt; &lt;&lt;<br>vmap &lt;D-[&gt; &lt;gv<br>vmap &lt;D-]&gt; &gt;gv</p><p>“ eggcache vim<br>nnoremap ; :<br>:command W w<br>:command WQ wq<br>:command Wq wq<br>:command Q q<br>:command Qa qa<br>:command QA qa</p><p>“ for macvim<br>if has(“gui_running”)<br>set go&#x3D;aAce “ remove toolbar<br>“set transparency&#x3D;30<br>set guifont&#x3D;Monaco:h13<br>set showtabline&#x3D;2<br>set columns&#x3D;140<br>set lines&#x3D;40<br>noremap<d-m-left>:tabprevious<cr><br>noremap<d-m-right>:tabnext<cr><br>map<d-1>1gt<br>map<d-2>2gt<br>map<d-3>3gt<br>map<d-4>4gt<br>map<d-5>5gt<br>map<d-6>6gt<br>map<d-7>7gt<br>map<d-8>8gt<br>map<d-9>9gt<br>map<d-0>:tablast<cr><br>endif</cr></d-0></d-9></d-8></d-7></d-6></d-5></d-4></d-3></d-2></d-1></cr></d-m-right></cr></d-m-left></p><h3 id="vimrc3"><a href="#vimrc3" class="headerlink" title="vimrc3"></a>vimrc3</h3><p>“””””””””””””””””””””””””””””””””””””””””””””””””””””””””””””””””””””<br>“ 搜索和匹配<br>“””””””””””””””””””””””””””””””””””””””””””””””””””””””””””””””””””””<br>“ 高亮显示匹配的括号<br>set showmatch</p><p>“ 匹配括号高亮的时间（单位是十分之一秒）<br>set matchtime&#x3D;5</p><p>“ 在搜索的时候忽略大小写<br>set ignorecase</p><p>“ 不要高亮被搜索的句子（phrases）<br>set nohlsearch</p><p>“ 在搜索时，输入的词句的逐字符高亮（类似firefox的搜索）<br>set incsearch</p><p>“ 输入:set list命令是应该显示些啥？<br>set listchars&#x3D;tab:|\ ,trail:.,extends:&gt;,precedes:&lt;,eol:$</p><p>“ 光标移动到buffer的顶部和底部时保持3行距离<br>set scrolloff&#x3D;3</p><p>“ 总是显示状态行<br>set laststatus&#x3D;2</p><p>“””””””””””””””””””””””””””””””””””””””””””””””””””””””””””””””””””””<br>“ 文本格式和排版<br>“””””””””””””””””””””””””””””””””””””””””””””””””””””””””””””””””””””<br>“ 自动格式化<br>set formatoptions&#x3D;tcrqn</p><p>“ 继承前一行的缩进方式，特别适用于多行注释<br>set autoindent</p><p>“ 为C程序提供自动缩进<br>set smartindent</p><p>“ 使用C样式的缩进<br>set cindent</p><p>“ 制表符为4<br>set tabstop&#x3D;4</p><p>“ 统一缩进为4<br>set softtabstop&#x3D;4<br>set shiftwidth&#x3D;4</p><p>“ 不要用空格代替制表符<br>set noexpandtab</p><p>“ 不要换行<br>set nowrap</p><p>“ 在行和段开始处使用制表符<br>set smarttab</p><p>“””””””””””””””””””””””””””””””””””””””””””””””””””””””””””””””””””””<br>“ Autocommands<br>“””””””””””””””””””””””””””””””””””””””””””””””””””””””””””””””””””””<br>“ 只在下列文件类型被侦测到的时候显示行号，普通文本文件不显示</p><p>if has(“autocmd”)<br>autocmd FileType xml,html,c,cs,java,perl,shell,bash,cpp,python,vim,php,ruby set number<br>autocmd FileType xml,html vmap<c-o><esc>‘&lt;i<br>autocmd FileType java,c,cpp,cs vmap<c-o><esc>‘&lt;o<br>autocmd FileType html,text,php,vim,c,java,xml,bash,shell,perl,python setlocal textwidth&#x3D;100<br>autocmd Filetype html,xml,xsl source $VIMRUNTIME&#x2F;plugin&#x2F;closetag.vim<br>autocmd BufReadPost *<br>\ if line(“‘&quot;“) &gt; 0 &amp;&amp; line(“‘&quot;“) &lt;&#x3D; line(“$”) |<br>\ exe “ normal g&#96;&quot;“ |<br>\ endif<br>endif “has(“autocmd”)</esc></c-o></esc></c-o></p><p>“ F5编译和运行C程序，F6编译和运行C++程序<br>“ 请注意，下述代码在windows下使用会报错<br>“ 需要去掉.&#x2F;这两个字符</p><p>“ C的编译和运行<br>map<f5>:call CompileRunGcc()<cr><br>func! CompileRunGcc()<br>exec “w”<br>exec “!gcc % -o %&lt;”<br>exec “! .&#x2F;%&lt;”<br>endfunc</cr></f5></p><p>“ C++的编译和运行<br>map<f6>:call CompileRunGpp()<cr><br>func! CompileRunGpp()<br>exec “w”<br>exec “!g++ % -o %&lt;”<br>exec “! .&#x2F;%&lt;”<br>endfunc</cr></f6></p><p>“ 能够漂亮地显示.NFO文件<br>set encoding&#x3D;utf-8<br>function! SetFileEncodings(encodings)<br>let b:myfileencodingsbak&#x3D;&amp;fileencodings<br>let &amp;fileencodings&#x3D;a:encodings<br>endfunction<br>function! RestoreFileEncodings()<br>let &amp;fileencodings&#x3D;b:myfileencodingsbak<br>unlet b:myfileencodingsbak<br>endfunction</p><p>au BufReadPre *.nfo call SetFileEncodings(‘cp437’)|set ambiwidth&#x3D;single au BufReadPost *.nfo call RestoreFileEncodings()</p><p>“ 用空格键来开关折叠<br>set foldenable<br>set foldmethod&#x3D;manual<br>nnoremap<space>@&#x3D;((foldclosed(line(‘.’)) &lt; 0) ? ‘zc’:’zo’)<cr></cr></space></p></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/images/avatar.jpg" onerror='this.onerror=null,this.src="/img/friend_404.gif"' alt="avatar"></div><div class="author-info__name">Janvy Sun</div><div class="author-info__description"></div></div><div class="card-info-data is-center"><div class="card-info-data-item"><a href="/archives/"><div class="headline">文章</div><div class="length-num">153</div></a></div><div class="card-info-data-item"><a href="/tags/"><div class="headline">标签</div><div class="length-num">47</div></a></div><div class="card-info-data-item"><a href="/categories/"><div class="headline">分类</div><div class="length-num">13</div></a></div></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/xxxxxx"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/janvysun" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:janvusun@outlook.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="sticky_layout"><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/lyrics/1f1e25e2-0756-4881-9cc2-b146d03c0ae6.html" title="世界が終るまでは…"><img src="/images/hexo.png" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="世界が終るまでは…"></a><div class="content"><a class="title" href="/lyrics/1f1e25e2-0756-4881-9cc2-b146d03c0ae6.html" title="世界が終るまでは…">世界が終るまでは…</a><time datetime="2024-04-20T16:00:00.000Z" title="发表于 2024-04-21 00:00:00">2024-04-21</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/games/bdac0118-3bf7-43f9-9856-142e616b1ca4.html" title="我的世界攻略"><img src="/images/hexo.png" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="我的世界攻略"></a><div class="content"><a class="title" href="/games/bdac0118-3bf7-43f9-9856-142e616b1ca4.html" title="我的世界攻略">我的世界攻略</a><time datetime="2024-03-31T16:00:00.000Z" title="发表于 2024-04-01 00:00:00">2024-04-01</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/elk/3d7c2057-e448-4b83-a185-8d98e973490e.html" title="Nginx 的安装与使用"><img src="/images/hexo.png" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="Nginx 的安装与使用"></a><div class="content"><a class="title" href="/elk/3d7c2057-e448-4b83-a185-8d98e973490e.html" title="Nginx 的安装与使用">Nginx 的安装与使用</a><time datetime="2024-03-10T16:00:00.000Z" title="发表于 2024-03-11 00:00:00">2024-03-11</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/games/967c02f7-0d5e-4dd8-a2e0-70c97840fc5d.html" title="真三国无双 7 攻略"><img src="/images/hexo.png" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="真三国无双 7 攻略"></a><div class="content"><a class="title" href="/games/967c02f7-0d5e-4dd8-a2e0-70c97840fc5d.html" title="真三国无双 7 攻略">真三国无双 7 攻略</a><time datetime="2024-02-29T16:00:00.000Z" title="发表于 2024-03-01 00:00:00">2024-03-01</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/docker/4c765195-289e-4cc4-88fb-12d9bb5fed61.html" title="Docker Compose 使用"><img src="/images/hexo.png" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="Docker Compose 使用"></a><div class="content"><a class="title" href="/docker/4c765195-289e-4cc4-88fb-12d9bb5fed61.html" title="Docker Compose 使用">Docker Compose 使用</a><time datetime="2023-12-31T16:00:00.000Z" title="发表于 2024-01-01 00:00:00">2024-01-01</time></div></div></div></div><div class="card-widget card-categories"><div class="item-headline"><i class="fas fa-folder-open"></i> <span>分类</span> <a class="card-more-btn" href="/categories/" title="查看更多"><i class="fas fa-angle-right"></i></a></div><ul class="card-category-list" id="aside-cat-list"><li class="card-category-list-item"><a class="card-category-list-link" href="/categories/C/"><span class="card-category-list-name">C++</span><span class="card-category-list-count">22</span></a></li><li class="card-category-list-item"><a class="card-category-list-link" href="/categories/Database/"><span class="card-category-list-name">Database</span><span class="card-category-list-count">7</span></a></li><li class="card-category-list-item"><a class="card-category-list-link" href="/categories/DesignPattern/"><span class="card-category-list-name">DesignPattern</span><span class="card-category-list-count">24</span></a></li><li class="card-category-list-item"><a class="card-category-list-link" href="/categories/Docker/"><span class="card-category-list-name">Docker</span><span class="card-category-list-count">7</span></a></li><li class="card-category-list-item"><a class="card-category-list-link" href="/categories/Games/"><span class="card-category-list-name">Games</span><span class="card-category-list-count">2</span></a></li><li class="card-category-list-item"><a class="card-category-list-link" href="/categories/Java/"><span class="card-category-list-name">Java</span><span class="card-category-list-count">21</span></a></li><li class="card-category-list-item"><a class="card-category-list-link" href="/categories/Linux/"><span class="card-category-list-name">Linux</span><span class="card-category-list-count">15</span></a></li><li class="card-category-list-item"><a class="card-category-list-link" href="/categories/Other/"><span class="card-category-list-name">Other</span><span class="card-category-list-count">7</span></a></li></ul></div><div class="card-widget card-tags"><div class="item-headline"><i class="fas fa-tags"></i><span>标签</span></div><div class="card-tag-cloud"><a href="/tags/Bash/" style="font-size:1.17em;color:#999ca0">Bash</a> <a href="/tags/C/" style="font-size:1.1em;color:#999">C++</a> <a href="/tags/CAS/" style="font-size:1.32em;color:#99a2ae">CAS</a> <a href="/tags/CMake/" style="font-size:1.25em;color:#999fa7">CMake</a> <a href="/tags/Clang-Format/" style="font-size:1.1em;color:#999">Clang-Format</a> <a href="/tags/Clion/" style="font-size:1.14em;color:#999a9c">Clion</a> <a href="/tags/DB2/" style="font-size:1.17em;color:#999ca0">DB2</a> <a href="/tags/Docker/" style="font-size:1.35em;color:#99a3b1">Docker</a> <a href="/tags/ELK/" style="font-size:1.17em;color:#999ca0">ELK</a> <a href="/tags/Exception/" style="font-size:1.1em;color:#999">Exception</a> <a href="/tags/Git/" style="font-size:1.32em;color:#99a2ae">Git</a> <a href="/tags/GitHub/" style="font-size:1.1em;color:#999">GitHub</a> <a href="/tags/IDEA/" style="font-size:1.14em;color:#999a9c">IDEA</a> <a href="/tags/Java/" style="font-size:1.5em;color:#99a9bf">Java</a> <a href="/tags/Linux/" style="font-size:1.46em;color:#99a8bc">Linux</a> <a href="/tags/Lyrics/" style="font-size:1.28em;color:#99a0aa">Lyrics</a> <a href="/tags/Markdown/" style="font-size:1.1em;color:#999">Markdown</a> <a href="/tags/Maven/" style="font-size:1.21em;color:#999da3">Maven</a> <a href="/tags/MongoDB/" style="font-size:1.1em;color:#999">MongoDB</a> <a href="/tags/MySQL/" style="font-size:1.1em;color:#999">MySQL</a> <a href="/tags/Nacos/" style="font-size:1.1em;color:#999">Nacos</a> <a href="/tags/Nginx/" style="font-size:1.1em;color:#999">Nginx</a> <a href="/tags/Python/" style="font-size:1.43em;color:#99a6b8">Python</a> <a href="/tags/QT/" style="font-size:1.14em;color:#999a9c">QT</a> <a href="/tags/Redis/" style="font-size:1.1em;color:#999">Redis</a> <a href="/tags/SQL/" style="font-size:1.1em;color:#999">SQL</a> <a href="/tags/STL/" style="font-size:1.17em;color:#999ca0">STL</a> <a href="/tags/Selenium/" style="font-size:1.1em;color:#999">Selenium</a> <a href="/tags/Spring-Boot/" style="font-size:1.39em;color:#99a5b5">Spring Boot</a> <a href="/tags/UML/" style="font-size:1.1em;color:#999">UML</a> <a href="/tags/Ubuntu/" style="font-size:1.1em;color:#999">Ubuntu</a> <a href="/tags/Vim/" style="font-size:1.32em;color:#99a2ae">Vim</a> <a href="/tags/Vue/" style="font-size:1.1em;color:#999">Vue</a> <a href="/tags/bash/" style="font-size:1.1em;color:#999">bash</a> <a href="/tags/html/" style="font-size:1.1em;color:#999">html</a> <a href="/tags/node-js/" style="font-size:1.1em;color:#999">node.js</a> <a href="/tags/%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/" style="font-size:1.1em;color:#999">并发编程</a> <a href="/tags/%E6%8C%87%E9%92%88/" style="font-size:1.25em;color:#999fa7">指针</a> <a href="/tags/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/" style="font-size:1.1em;color:#999">正则表达式</a> <a href="/tags/%E6%B3%A8%E9%87%8A/" style="font-size:1.1em;color:#999">注释</a></div></div><div class="card-widget card-webinfo"><div class="item-headline"><i class="fas fa-chart-line"></i><span>网站资讯</span></div><div class="webinfo"><div class="webinfo-item"><div class="item-name">文章数目 :</div><div class="item-count">153</div></div><div class="webinfo-item"><div class="item-name">已运行时间 :</div><div class="item-count" id="runtimeshow" data-publishdate="2018-03-01T16:00:00.000Z"></div></div><div class="webinfo-item"><div class="item-name">本站总字数 :</div><div class="item-count">346.2k</div></div><div class="webinfo-item"><div class="item-name">本站访客数 :</div><div class="item-count" id="busuanzi_value_site_uv"></div></div><div class="webinfo-item"><div class="item-name">本站总访问量 :</div><div class="item-count" id="busuanzi_value_site_pv"></div></div><div class="webinfo-item"><div class="item-name">最后更新时间 :</div><div class="item-count" id="last-push-date" data-lastpushdate="2024-04-23T14:25:43.370Z"></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2018 - 2024 By Janvy Sun</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">本地搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span> 数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"></div></div><hr><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.js"></script><script src="/js/search/local-search.js"></script><script>var preloader={endLoading:()=>{document.body.style.overflow="auto",document.getElementById("loading-box").classList.add("loaded")},initLoading:()=>{document.body.style.overflow="",document.getElementById("loading-box").classList.remove("loaded")}};window.addEventListener("load",preloader.endLoading())</script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>